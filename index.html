<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multi-UVTools</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="stylesheet" href="css/styles.css" />
    <style>
      /* Settings Tabs */
      .settings-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 0;
        margin-bottom: 0;
        border-bottom: 2px solid var(--border);
      }
      .settings-tabs .tab-btn {
        padding: 0.75rem 1.5rem;
        background: transparent;
        border: none;
        border-bottom: 2px solid transparent;
        margin-bottom: -2px;
        color: var(--text-muted);
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .settings-tabs .tab-btn:hover {
        color: var(--text);
        background: var(--bg-hover);
      }
      .settings-tabs .tab-btn.active {
        color: var(--primary);
        border-bottom-color: var(--primary);
      }
      .settings-tabs .tab-btn svg {
        width: 18px;
        height: 18px;
        stroke: currentColor;
      }
      .tab-content {
        display: none !important;
        padding: 1.5rem;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-top: none;
        border-radius: 0 0 8px 8px;
      }
      .tab-content.active {
        display: block !important;
      }
      /* Radio FM Table */
      .radio-actions {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }
      .radio-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
      }
      .radio-table th, .radio-table td {
        padding: 0.5rem;
        border: 1px solid var(--border);
        text-align: left;
      }
      .radio-table th {
        background: var(--bg-darker, #e0e0e0);
        font-weight: 600;
      }
      .radio-table input[type="number"] {
        width: 150px;
        padding: 0.25rem 0.5rem;
        border: 1px solid var(--border);
        border-radius: 4px;
        background: var(--bg-input);
        color: var(--text);
      }
      /* DTMF Table */
      .dtmf-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
      }
      .dtmf-table th,
      .dtmf-table td {
        padding: 0.5rem;
        text-align: left;
        border-bottom: 1px solid var(--border);
      }
      .dtmf-table th {
        font-weight: 600;
        color: var(--text-muted);
        font-size: 0.85rem;
        text-transform: uppercase;
      }
      .dtmf-table input {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid var(--border);
        border-radius: 4px;
        background: var(--bg-input);
        color: var(--text);
        font-family: monospace;
      }
      .dtmf-table input:focus {
        outline: none;
        border-color: var(--primary);
      }
      .dtmf-table .index-col {
        width: 50px;
        text-align: center;
        color: var(--text-muted);
      }
      .dtmf-table .clear-btn {
        padding: 0.25rem 0.5rem;
        background: var(--bg-hover);
        border: 1px solid var(--border);
        border-radius: 4px;
        color: var(--text-muted);
        cursor: pointer;
      }
      .dtmf-table .clear-btn:hover {
        background: var(--danger);
        color: white;
        border-color: var(--danger);
      }
      .dtmf-actions {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }
      
      /* Danger button (red) */
      button.danger {
        background: var(--danger);
        color: white;
        border-color: var(--danger);
      }
      button.danger:hover:not(:disabled) {
        background: #c62828;
        border-color: #c62828;
      }
      button.danger:disabled {
        background: var(--bg-secondary);
        color: var(--text-muted);
        border-color: var(--border-color);
        cursor: not-allowed;
        opacity: 0.5;
      }
      
      /* Calibration Section Styles */
      
      /* Hidden elements for collapsible sections */
      .hidden {
        display: none !important;
      }
      
      .calib-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.85rem;
        background: var(--surface-1);
        border-radius: 8px;
        overflow: hidden;
      }
      .calib-table th, .calib-table td {
        padding: 0.5rem;
        text-align: center;
        border: 1px solid var(--border-color);
      }
      .calib-table th {
        background: var(--primary);
        color: white;
        font-weight: 600;
      }
      .calib-table tr:nth-child(even) {
        background: var(--surface-2);
      }
      .calib-input {
        width: 70px;
        padding: 0.3rem;
        text-align: center;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        background: var(--surface-1);
        color: var(--text-primary);
        font-size: 0.85rem;
      }
      .calib-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 2px rgba(233, 69, 96, 0.2);
      }
      .calib-group {
        background: var(--surface-1);
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid var(--border-color);
      }
      .tab-btn {
        padding: 0.5rem 1rem;
        border: 1px solid var(--border-color);
        background: var(--surface-1);
        color: var(--text-primary);
        cursor: pointer;
        border-radius: 4px;
        font-size: 0.85rem;
        transition: all 0.2s;
      }
      .tab-btn:hover {
        background: var(--surface-2);
      }
      .tab-btn.active {
        background: var(--primary);
        color: white;
        border-color: var(--primary);
      }
      #calibrationPanel .field-group {
        margin-bottom: 0.5rem;
      }
      #calibrationPanel .field-group label {
        display: block;
        font-size: 0.8rem;
        color: var(--text-muted);
        margin-bottom: 0.2rem;
      }
    </style>
  </head>
  <body>
    <div class="theme-switcher">
        <label for="themeSelect" class="theme-label">Theme:</label>
        <select id="themeSelect">
          <optgroup label="‚îÄ‚îÄ Dark Themes ‚îÄ‚îÄ">
            <option value="dark">üåô Dark</option>
            <option value="midnight">üåå Midnight</option>
            <option value="ocean">üåä Ocean</option>
            <option value="forest">üå≤ Forest</option>
            <option value="sunset">üåÖ Sunset</option>
            <option value="cyberpunk">üíú Cyberpunk</option>
            <option value="retro">üìü Retro</option>
          </optgroup>
          <optgroup label="‚îÄ‚îÄ Popular Themes ‚îÄ‚îÄ">
            <option value="nord">‚ùÑÔ∏è Nord</option>
            <option value="dracula">üßõ Dracula</option>
            <option value="monokai">üé® Monokai</option>
            <option value="solarized">‚òÄÔ∏è Solarized</option>
            <option value="gruvbox">üü† Gruvbox</option>
            <option value="tokyo">üóº Tokyo Night</option>
            <option value="catppuccin">üê± Catppuccin</option>
            <option value="rosepine">üå∏ Ros√© Pine</option>
            <option value="onedark">‚ö´ One Dark</option>
          </optgroup>
          <optgroup label="‚îÄ‚îÄ Light Themes ‚îÄ‚îÄ">
            <option value="light">‚òÄÔ∏è Light</option>
            <option value="cream">üç¶ Cream</option>
            <option value="bluelight">üîµ Blue Light</option>
            <option value="lavender">üíú Lavender</option>
            <option value="mint">üåø Mint</option>
            <option value="roselight">üåπ Rose</option>
            <option value="paper">üìÑ Paper</option>
            <option value="sky">üå§Ô∏è Sky</option>
          </optgroup>
          <optgroup label="‚îÄ‚îÄ Accessibility ‚îÄ‚îÄ">
            <option value="contrast">‚ö° High Contrast</option>
          </optgroup>
        </select>
      </div>
      
      <!-- Navigation Bar - visible on all pages -->
      <nav class="main-nav">
        <div class="nav-top">
          <a href="#home" class="nav-brand">Multi-UVTools</a>
          <div class="nav-links">
            <a href="#instructions" class="nav-item" data-nav="instructions">Home</a>
            <a href="#home" class="nav-item k5-tk11-only" data-nav="home">Tools</a>
            <a href="#k1" class="nav-item k5-only" data-nav="k1">Flash</a>
            <a href="#channels" class="nav-item k5-only" data-nav="channels">Channels</a>
            <a href="#settings" class="nav-item k5-only" data-nav="settings">Settings</a>
            <a href="#tk11-settings" class="nav-item tk11-only" data-nav="tk11-settings" style="display: none;">Settings</a>
            <a href="#mirror" class="nav-item k5-only" data-nav="mirror">Mirror</a>
            <a href="#smr" class="nav-item k5-only" data-nav="smr">SMR</a>
            <a href="#unbricking" class="nav-item k5-only" data-nav="unbricking">Unbricking</a>
          </div>
        </div>
        <div class="nav-status">
          <select id="radioTypeSelect" class="radio-type-select nav-radio-type" title="Select Radio Type">
            <option value="K5" selected>üìª UV-K5/K1</option>
            <option value="TK11">üìª TK11</option>
            <option value="RT890">üìª RT-890</option>
          </select>
          <span class="status-dot" id="homeStatusDot" data-status="disconnected"></span>
          <span id="connectionLabel" class="status-label">Disconnected</span>
          <span id="deviceInfo" class="status-device">No port</span>
          <span id="firmwareInfo" class="status-firmware">-</span>
          <select id="baudSelect" class="nav-baud">
            <option value="38400" selected>38400</option>
            <option value="115200">115200</option>
          </select>
          <button id="connectBtn" class="nav-btn primary">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="16" height="16">
              <path d="M8 12h8"></path>
              <path d="M5 12l3-3v6l-3-3z"></path>
              <path d="M19 12l-3 3V9l3 3z"></path>
            </svg>
            Connect
          </button>
          <button id="disconnectBtn" class="nav-btn ghost" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2" width="16" height="16">
              <path d="M6 6l12 12"></path>
              <path d="M18 6l-12 12"></path>
            </svg>
            Disconnect
          </button>
        </div>
      </nav>
      
      <main class="app tool-scope">
      <section class="page" id="instructions" data-page>
        <header class="hero k5-tk11-only">
          <div>
            <p class="eyebrow">INTRO</p>
            <h1>Instructions</h1>
            <p class="subtitle">
              Welcome to Multi-UVTools. This application helps you manage your Quansheng radio.
            </p>
          </div>
        </header>

        <header class="hero rt890-only" style="display: none;">
          <div>
            <p class="eyebrow">INTRO</p>
            <h1>Instructions</h1>
            <p class="subtitle">
              Welcome to Multi-UVTools. This application helps you manage your Radtel radio.
            </p>
          </div>
        </header>

        <!-- K5 Instructions -->
        <section class="panel k5-only">
          <h2>Getting Started</h2>
          <p>Connect your radio via USB. Baud rate: 38400 (Default) / 115200 (Specific firmwares).</p>
          <h3>Available Features:</h3>
          <ul style="list-style: disc; margin-left: 2rem; line-height: 1.8;">
            <li><strong>Tools:</strong> Memory backup/restore, calibration management, and HEX view</li>
            <li><strong>Flash:</strong> Flash firmware for UV-K5/K6/5R and UV-K5 V3/K1 radios</li>
            <li><strong>Channels:</strong> Read, edit and write channels to the radio</li>
            <li><strong>Settings:</strong> Edit basic settings, DTMF contacts, and FM radio frequencies</li>
            <li><strong>Mirror:</strong> Mirror the radio display in real time</li>
            <li><strong>SMR:</strong> Short message radio for sending and receiving SMS frames</li>
          </ul>
          <h3>Boot Mode:</h3>
          <p>To flash firmware, connect the radio in boot mode by holding PTT while turning on the power.</p>


          <div style="margin-top: 1.5rem; padding: 1.2rem; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 1px solid #0f3460; border-radius: 12px;">
            <h3 style="color: #ffd700; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              ‚≠ê Complete Documentation of the Quansheng UV-K5 ‚Äî Wiki by Ludwich66
            </h3>
            <p style="color: #a2d2ff; line-height: 1.6; margin-bottom: 0.5rem;">
              An exceptional work of documentation and reference.
            </p>
            <p style="margin-top: 0.8rem;">
              <a href="https://github.com/ludwich66/Quansheng_UV-K5_Wiki" target="_blank" style="color: #ffd700; text-decoration: none; font-weight: bold; display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                View Wiki on GitHub
              </a>
            </p>
          </div>
          <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 1px solid #0f3460; border-radius: 12px;">
            <h3 style="color: #e94560; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
              Open Source Project
            </h3>
            <p style="color: #a2d2ff; line-height: 1.6; margin-bottom: 0.5rem;">
              This website is available on my GitHub (<a href="https://github.com/spm81/Multi-UVTools" target="_blank" style="color: #e94560; text-decoration: none; font-weight: bold;">spm81</a>) <strong style="color: #fff;">Matoz</strong>.
            </p>
            <p style="color: #a2d2ff; line-height: 1.6; margin-bottom: 0.5rem;">
              The code is open so that everyone can contribute to and improve the site. You can also ask to add your custom firmware or simply make pull requests on GitHub, and I will then add them to my code.
            </p>
            <p style="color: #e94560; font-weight: bold; font-size: 1.1rem; margin-top: 1rem;">
              I hope you enjoy my work! üöÄ
            </p>
          </div>
        </section>
        
        <!-- TK11 Instructions -->
        <section class="panel tk11-only" style="display: none;">
          <h2>Getting Started</h2>
          <p>Connect your radio via USB. Baud rate: 115200 (Default).</p>
          <h3>Available Features:</h3>
          <ul style="list-style: disc; margin-left: 2rem; line-height: 1.8;">
            <li><strong>Tools:</strong> Standard radio operations (Dump EEPROM, restore, calibration management, HEX view)</li>
            <li><strong>Settings:</strong> Read and write TK11 settings</li>
          </ul>

          <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 1px solid #0f3460; border-radius: 12px;">
            <h3 style="color: #e94560; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
              Open Source Project
            </h3>
            <p style="color: #a2d2ff; line-height: 1.6; margin-bottom: 0.5rem;">
              This website is available on my GitHub (<a href="https://github.com/spm81/Multi-UVTools" target="_blank" style="color: #e94560; text-decoration: none; font-weight: bold;">spm81</a>) <strong style="color: #fff;">Matoz</strong>.
            </p>
            <p style="color: #a2d2ff; line-height: 1.6; margin-bottom: 0.5rem;">
              The code is open so that everyone can contribute to and improve the site. You can also ask to add your custom firmware or simply make pull requests on GitHub, and I will then add them to my code.
            </p>
            <p style="color: #e94560; font-weight: bold; font-size: 1.1rem; margin-top: 1rem;">
              I hope you enjoy my work! üöÄ
            </p>
            <p style="margin-top: 0.8rem;">
              <a href="https://t.me/tk11quansheng" target="_blank" style="color: #e94560; text-decoration: none; font-weight: bold; display: inline-flex; align-items: center; gap: 0.5rem;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>
                Join TK11 Telegram Group
              </a>
            </p>
          </div>
        </section>
        
        <!-- RT890 Instructions -->
        <section class="panel rt890-only" style="display: none;">
          <h2>Getting Started</h2>
          <p>Connect your radio via USB. Baud rate: 115200 (Default).</p>
          <h3>Available Features:</h3>
          <ul style="list-style: disc; margin-left: 2rem; line-height: 1.8;">
            <li><strong>Flash:</strong> Flash firmware for RT-890 radios</li>
          </ul>

          <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 1px solid #0f3460; border-radius: 12px;">
            <h3 style="color: #e94560; margin-bottom: 0.8rem; display: flex; align-items: center; gap: 0.5rem;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
              Open Source Project
            </h3>
            <p style="color: #a2d2ff; line-height: 1.6; margin-bottom: 0.5rem;">
              This website is available on my GitHub (<a href="https://github.com/spm81/Multi-UVTools" target="_blank" style="color: #e94560; text-decoration: none; font-weight: bold;">spm81</a>) <strong style="color: #fff;">Matoz</strong>.
            </p>
            <p style="color: #a2d2ff; line-height: 1.6; margin-bottom: 0.5rem;">
              The code is open so that everyone can contribute to and improve the site. You can also ask to add your custom firmware or simply make pull requests on GitHub, and I will then add them to my code.
            </p>
            <p style="color: #e94560; font-weight: bold; font-size: 1.1rem; margin-top: 1rem;">
              I hope you enjoy my work! üöÄ
            </p>
          </div>
        </section>
      </section>

      <section class="page" id="home" data-page>
        <header class="hero">
          <div>
            <p class="eyebrow" id="toolsEyebrow">UV-K5/K1 TOOLSET</p>
            <h1>Tools to manage your radio.</h1>
            <p class="subtitle">
              Connect the radio to backup, restore, firmware update, channel editing and basic settings.
            </p>
            <p class="subtitle muted" style="font-size: 0.9rem; margin-top: 0.5rem;">
              <span class="k5-only">Memory: 8 KB EEPROM | 200 Channels | External EEPROM</span>
              <span class="tk11-only" style="display: none;">Memory: 1532 KB (12 Mbit) (0x17EF00) | 999 Channels | Internal Flash</span>
            </p>
            <div class="tk11-only" style="display: none; margin-top: 1rem; padding: 1rem; background: #f59e0b22; border: 1px solid #f59e0b; border-radius: 8px; color: #f59e0b;">
              ‚ö†Ô∏è <strong>TK11 support is a work in progress.</strong> It works but needs fine-tuning (Everything should be working correctly).
            </div>
          </div>
        </header>

        <section class="panel-grid">
          <!-- 1. EEPROM backup -->
          <section class="panel">
            <h2><span class="memory-type-label">EEPROM</span> backup</h2>
            <p class="muted">Save the radio's current configuration.</p>
            <button id="backupBtn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 3v12" />
                  <path d="M7 10l5 5 5-5" />
                  <path d="M4 20h16" />
                </svg>
              </span>
              Backup EEPROM
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="backupPct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="backupFill"></div>
              </div>
            </div>
            <p class="hint" id="backupHint">The file will be downloaded as .bin.</p>
          </section>

          <!-- 3. Restore EEPROM -->
          <section class="panel">
            <h2>Restore <span class="memory-type-label">EEPROM</span></h2>
            <p class="muted">Restore a backup file to the radio.</p>
            <div class="field-row">
              <input type="file" id="restoreFile" accept=".bin" />
            </div>
            <button id="restoreBtn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9" />
                  <path d="M7 14l5-5 5 5" />
                  <path d="M4 4h16" />
                </svg>
              </span>
              Restore <span class="memory-type-label">EEPROM</span>
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="restorePct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="restoreFill"></div>
              </div>
            </div>
          </section>

          <!-- 4. Dump Calibration -->
          <section class="panel k5-calib-only">
            <h2>Dump Calibration</h2>
            <p class="muted">Save the calibration area (0x1E00-0x2000).</p>
            <button id="dumpCalibK5Btn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 3v12" />
                  <path d="M7 10l5 5 5-5" />
                  <path d="M4 20h16" />
                </svg>
              </span>
              Dump Calibration
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="dumpCalibK5Pct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="dumpCalibK5Fill"></div>
              </div>
            </div>
            <p class="hint">Calibration file will be downloaded as .bin.</p>
          </section>

          <!-- 5. Restore Calibration -->
          <section class="panel k5-calib-only">
            <h2>Restore Calibration</h2>
            <p class="muted">Restore calibration data from a backup file.</p>
            <div class="field-row">
              <input type="file" id="restoreCalibK5File" accept=".bin" />
            </div>
            <button id="restoreCalibK5Btn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9" />
                  <path d="M7 14l5-5 5 5" />
                  <path d="M4 4h16" />
                </svg>
              </span>
              Restore Calibration
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="restoreCalibK5Pct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="restoreCalibK5Fill"></div>
              </div>
            </div>
            <p class="hint">Expected size: 512 bytes.</p>
          </section>

          <!-- TK11 Dump Calibration -->
          <section class="panel tk11-only" style="display: none;">
            <h2>Dump Calibration</h2>
            <p class="muted">Save the calibration area (0x010000-0x021000) - 68 KB.</p>
            <button id="dumpCalibTK11Btn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 3v12" />
                  <path d="M7 10l5 5 5-5" />
                  <path d="M4 20h16" />
                </svg>
              </span>
              Dump Calibration
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="dumpCalibTK11Pct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="dumpCalibTK11Fill"></div>
              </div>
            </div>
            <p class="hint">TK11 calibration file will be downloaded as .bin (69632 bytes = 68 KB).</p>
          </section>

          <!-- TK11 Restore Calibration -->
          <section class="panel tk11-only" style="display: none;">
            <h2>Restore Calibration</h2>
            <p class="muted">Restore calibration data from a backup file (0x010000-0x021000).</p>
            <div class="field-row">
              <input type="file" id="restoreCalibTK11File" accept=".bin" />
            </div>
            <button id="restoreCalibTK11Btn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9" />
                  <path d="M7 14l5-5 5 5" />
                  <path d="M4 4h16" />
                </svg>
              </span>
              Restore Calibration
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="restoreCalibTK11Pct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="restoreCalibTK11Fill"></div>
              </div>
            </div>
            <p class="hint">Expected size: 69632 bytes (68 KB).</p>
          </section>

          <!-- 6. Default Calibrations -->
          <section class="panel k5-calib-only">
            <h2>Emergency Calibration Restore Tool</h2>
            <p class="muted">Restore calibration from pre-loaded files.</p>
            <p class="muted warning">‚ö†Ô∏è Warning: Use only in case of emergency (radio with password, locked radio, or misconfigured radio) and/or only if you do not have the calibration file for your radio.</p>

            <div class="field-row">
              <label for="defaultCalibSelect">Select Radio Model</label>
              <select id="defaultCalibSelect">
                <option value="">-- Select calibration --</option>
                <option value="calibrations/UV-K5.bin">UV-K5</option>
                <option value="calibrations/UV-K5(8).bin">UV-K5(8)</option>
                <option value="calibrations/UV-5R_Plus.bin">UV-5R_Plus</option>
                <option value="calibrations/UV-K5(99).bin">UV-K5(99)</option>
                <option value="calibrations/K5V3_calibration.dat">UV-K5(v3)</option>
                <option value="calibrations/UV-K1(8).bin">UV-K1(8)</option>
              </select>
            </div>
            <button id="restoreDefaultCalibBtn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9" />
                  <path d="M7 14l5-5 5 5" />
                  <path d="M4 4h16" />
                </svg>
              </span>
              Restore Default Calibration
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="defaultCalibPct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="defaultCalibFill"></div>
              </div>
            </div>
            <p class="hint" id="defaultCalibHint">Select a model to restore its default calibration.</p>
          </section>

          <!-- Memory Size Detector (K5 & TK11) -->
          <section class="panel" id="memorySizeDetectorSection">
            <h2><span class="memory-type-label">Check EEPROM Size</span></h2>
            <p class="muted">Automatically detects the size of your radio's memory using wrap-around test. This is safe and non-destructive.</p>
            
            <div class="field-row">
              <button id="detectMemorySizeBtn" class="primary" disabled>
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 6v6l4 2"></path>
                  </svg>
                </span>
                Detect Size
              </button>
            </div>

            <div id="memorySizeResult" class="memory-size-result"></div>

            <p class="muted" style="margin-top: 1rem;">
              <strong>Tested sizes:</strong> 8 KB, 64 KB, 128 KB, 256 KB, 512 KB, 1 MB, 2 MB
            </p>
          </section>

          <!-- EEPROM/Flash Cleaner (K5 & TK11) -->
          <section class="panel" id="eepromCleanerSection">
            <h2><span class="memory-type-label">Clean My EEPROM</span></h2>
            <p class="muted">‚ö†Ô∏è <strong>DESTRUCTIVE OPERATION</strong> - Fills entire memory with 0xFF (factory blank state) while protecting calibration areas.</p>
            
            <div class="field-row">
              <button id="cleanEepromBtn" class="danger" disabled>
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M3 6h18"></path>
                    <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"></path>
                    <line x1="10" y1="11" x2="10" y2="17"></line>
                    <line x1="14" y1="11" x2="14" y2="17"></line>
                  </svg>
                </span>
                Clean Memory
              </button>
            </div>

            <div class="progress-bar" id="cleanerProgressBar" style="display: none; margin-top: 15px;">
              <div class="progress-fill" id="cleanerProgressFill" style="width: 0%;"></div>
            </div>

            <div id="cleanerStatus" class="status-text"></div>

            <p class="muted" style="margin-top: 1rem;">
              <strong>Protected areas (NOT erased):</strong><br>
              <span class="k5-only">K5/K1: 0x1E00-0x2000 (512 bytes)</span>
              <span class="tk11-only">TK11: 0x010000-0x021000 (68 KB - Calibration)</span>
            </p>
          </section>

          <!-- Lock Radio Password (K5 & TK11) -->
          <section class="panel">
            <h2>Lock Radio Password</h2>
            <p class="muted">Manage startup password lock (6-digit PIN).</p>
            
            <!-- LCD Display -->
            <div class="field-row" style="margin-bottom: 15px;">
              <label>Current Password</label>
              <div style="font-family: 'Courier New', monospace; font-size: 32px; letter-spacing: 10px; background: #B8D4A8; color: #000; padding: 10px 20px; border-radius: 4px; text-align: center; border: 2px solid #8BA87A;">
                <span id="passwordLCD">______</span>
              </div>
            </div>

            <!-- Password Input -->
            <div class="field-row">
              <label for="passwordInput">New Password (6 digits)</label>
              <input type="text" id="passwordInput" placeholder="000000" maxlength="6" pattern="[0-9]{6}" style="font-family: 'Courier New', monospace; font-size: 18px; letter-spacing: 5px; text-align: center;" />
            </div>

            <!-- Buttons -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
              <button id="readPasswordBtn">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M12 3v18" />
                    <path d="M7 10l5 5 5-5" />
                    <path d="M4 20h16" />
                  </svg>
                </span>
                Read from Radio
              </button>
              <button id="writePasswordBtn">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M12 21V9" />
                    <path d="M7 14l5-5 5 5" />
                    <path d="M4 4h16" />
                  </svg>
                </span>
                Write to Radio
              </button>
            </div>

            <p class="hint" style="margin-top: 10px;">
              <strong>Address:</strong> 
              <span class="k5-only" style="display: none;">K5 EEPROM: 0x01F000 (INT32 Little Endian)</span>
              <span class="tk11-only" style="display: none;">TK11 Flash: 0x017000 (INT32 Little Endian)</span>
              <br>
              <strong>Tip:</strong> Enter empty password and write to disable lock. Pattern: FF FF FF FF FF FF FF
            </p>
          </section>


        </section>

        <!-- Advanced Tools Section -->
        <h2 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');">Advanced Tools <span class="collapse-icon">‚ñº</span></h2>
        <section class="panel-grid hidden">
          <!-- Read EEPROM / Flash Memory -->
          <section class="panel">
            <h2>
              <span class="k5-only" style="display: none;">Read EEPROM Memory</span>
              <span class="tk11-only" style="display: none;">Read Flash Memory</span>
            </h2>
            <p class="muted">
              <span class="k5-only" style="display: none;">Read EEPROM Memory contents from the radio.</span>
              <span class="tk11-only" style="display: none;">Read full Flash Memory contents from the radio.</span>
            </p>
            <div class="field-group">
              <label for="readEepromSize">Size</label>
              <select id="readEepromSizeK5" class="k5-only" style="display: none;">
                <option value="8192" selected>8 KB (64Kbit) (0x2000)</option>
                <option value="65536">64 KB (512Kbit) (0x10000)</option>
                <option value="262144">256 KB (2Mbit) (0x40000)</option>
                <option value="524288">512 KB (4Mbit) (0x80000)</option>
              </select>
              <select id="readEepromSizeTK11" class="tk11-only" style="display: none;">
                <option value="1568512" selected>1532 KB (12 Mbit) (0x17EF00) - Full Flash</option>
              </select>
            </div>
            <button id="readEepromBtn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 3v12" />
                  <path d="M7 10l5 5 5-5" />
                  <path d="M4 20h16" />
                </svg>
              </span>
              <span class="k5-only" style="display: none;">Read EEPROM Memory</span>
              <span class="tk11-only" style="display: none;">Read Flash Memory</span>
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="readEepromPct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="readEepromFill"></div>
              </div>
            </div>
            <p class="hint">
              <span class="k5-only" style="display: none;">Read EEPROM Memory as .bin file.</span>
              <span class="tk11-only" style="display: none;">Download full Flash Memory as .bin file.</span>
            </p>
          </section>

          <!-- Write EEPROM / Flash Memory -->
          <section class="panel">
            <h2>
              <span class="k5-only" style="display: none;">Write EEPROM Memory</span>
              <span class="tk11-only" style="display: none;">Write Flash Memory</span>
            </h2>
            <p class="muted">
              <span class="k5-only" style="display: none;">Write EEPROM Memory file to the radio.</span>
              <span class="tk11-only" style="display: none;">Write a full Flash Memory file to the radio.</span>
            </p>
            <div class="field-row">
              <input type="file" id="writeEepromFile" accept=".bin" />
            </div>
            <button id="writeEepromBtn">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9" />
                  <path d="M7 14l5-5 5 5" />
                  <path d="M4 4h16" />
                </svg>
              </span>
              <span class="k5-only" style="display: none;">Write EEPROM Memory</span>
              <span class="tk11-only" style="display: none;">Write Flash Memory</span>
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="writeEepromPct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="writeEepromFill"></div>
              </div>
            </div>
            <p class="hint">
              <span class="k5-only" style="display: none;">Write EEPROM Memory file to the radio.</span>
              <span class="tk11-only" style="display: none;">Write entire Flash Memory file to the radio.</span>
            </p>
          </section>
          <!-- DEV Tools - TK11 (Hidden until devmode) -->
          <section class="panel dev-panel tk11-dev" id="devToolsTK11Backup" style="display: none; border: 2px solid #f59e0b;">
            <h2 style="color: #f59e0b;">üîß Flash Memory Backup DEV (TK11)</h2>
            <p class="muted">Read custom Flash Memory range from the TK11 radio.</p>
            <div class="field-row" style="gap: 1rem; flex-wrap: wrap;">
              <div class="field-group">
                <label for="devBackupStartAddrTK11">Start Address</label>
                <input type="text" id="devBackupStartAddrTK11" value="0x0000" placeholder="0x0000" style="width: 120px;">
              </div>
              <div class="field-group">
                <label for="devBackupEndAddrTK11">End Address</label>
                <input type="text" id="devBackupEndAddrTK11" value="0x17EF00" placeholder="0x17EF00" style="width: 120px;">
              </div>
            </div>
            <button id="devBackupBtnTK11" style="background: #f59e0b;">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 3v12" />
                  <path d="M7 10l5 5 5-5" />
                  <path d="M4 20h16" />
                </svg>
              </span>
              Read Flash Memory Range
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="devBackupPctTK11">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="devBackupFillTK11"></div>
              </div>
            </div>
            <p class="hint" style="color: #f59e0b;">‚ö†Ô∏è Developer mode - use with caution! (TK11: 1532 KB (12 Mbit) (0x17EF00) full flash)</p>
          </section>

          <section class="panel dev-panel tk11-dev" id="devToolsTK11Restore" style="display: none; border: 2px solid #f59e0b;">
            <h2 style="color: #f59e0b;">üîß Restore Flash Memory DEV (TK11)</h2>
            <p class="muted">Write custom Flash Memory range to the TK11 radio.</p>
            <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
              <div class="field-group">
                <label for="devRestoreStartAddrTK11">Start Address</label>
                <input type="text" id="devRestoreStartAddrTK11" value="0x0000" placeholder="0x0000" style="width: 120px;">
              </div>
            </div>
            <div class="field-row">
              <input type="file" id="devRestoreFileTK11" accept=".bin" />
            </div>
            <button id="devRestoreBtnTK11" style="background: #f59e0b;">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9" />
                  <path d="M7 14l5-5 5 5" />
                  <path d="M4 4h16" />
                </svg>
              </span>
              Write Flash Memory Range
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="devRestorePctTK11">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="devRestoreFillTK11"></div>
              </div>
            </div>
            <p class="hint" style="color: #f59e0b;">‚ö†Ô∏è Developer mode - writes from Start Address! (TK11: 1532 KB (12 Mbit) (0x17EF00) max)</p>
          </section>

          <!-- DEV Tools - K5 (Hidden until devmode) -->
          <section class="panel dev-panel k5-dev" id="devToolsK5Backup" style="display: none; border: 2px solid #f59e0b;">
            <h2 style="color: #f59e0b;">üîß EEPROM Backup DEV (K5)</h2>
            <p class="muted">Read custom EEPROM range from the K5 radio.</p>
            <div class="field-row" style="gap: 1rem; flex-wrap: wrap;">
              <div class="field-group">
                <label for="devBackupStartAddrK5">Start Address</label>
                <input type="text" id="devBackupStartAddrK5" value="0x0000" placeholder="0x0000" style="width: 120px;">
              </div>
              <div class="field-group">
                <label for="devBackupEndAddrK5">End Address</label>
                <input type="text" id="devBackupEndAddrK5" value="0x2000" placeholder="0x2000" style="width: 120px;">
              </div>
            </div>
            <button id="devBackupBtnK5" style="background: #f59e0b;">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 3v12" />
                  <path d="M7 10l5 5 5-5" />
                  <path d="M4 20h16" />
                </svg>
              </span>
              Read EEPROM Range
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="devBackupPctK5">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="devBackupFillK5"></div>
              </div>
            </div>
            <p class="hint" style="color: #f59e0b;">‚ö†Ô∏è Developer mode - use with caution! (K5: max 512KB)</p>
          </section>

          <section class="panel dev-panel k5-dev" id="devToolsK5Restore" style="display: none; border: 2px solid #f59e0b;">
            <h2 style="color: #f59e0b;">üîß Restore EEPROM DEV (K5)</h2>
            <p class="muted">Write custom EEPROM range to the K5 radio.</p>
            <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
              <div class="field-group">
                <label for="devRestoreStartAddrK5">Start Address</label>
                <input type="text" id="devRestoreStartAddrK5" value="0x0000" placeholder="0x0000" style="width: 120px;">
              </div>
            </div>
            <div class="field-row">
              <input type="file" id="devRestoreFileK5" accept=".bin" />
            </div>
            <button id="devRestoreBtnK5" style="background: #f59e0b;">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9" />
                  <path d="M7 14l5-5 5 5" />
                  <path d="M4 4h16" />
                </svg>
              </span>
              Write EEPROM Range
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="devRestorePctK5">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="devRestoreFillK5"></div>
              </div>
            </div>
            <p class="hint" style="color: #f59e0b;">‚ö†Ô∏è Developer mode - writes from Start Address! (K5)</p>
          </section>
        </section>



        <!-- Calibration Section (K5 Only) -->
        <h2 class="section-title collapsible collapsed k5-only" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');">Calibration <span class="collapse-icon">‚ñº</span></h2>
        <section class="panel hidden k5-only" id="calibrationPanel">
          <p class="muted">‚ö†Ô∏è <strong>WARNING:</strong> Modifying calibration values may damage your radio! Make sure you have a backup before making any changes.</p>
          
          <!-- Calibration Controls -->
          <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
            <button id="calibReadBtn" class="primary">
              <span class="icon">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M21 12V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h7"/>
                  <path d="m16 19 2 2 4-4"/>
                </svg>
              </span>
              Read Calibration
            </button>
            <button id="calibWriteBtn" class="warning" disabled>
              <span class="icon">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M12 21V9"/>
                  <path d="M7 14l5-5 5 5"/>
                  <path d="M4 4h16"/>
                </svg>
              </span>
              Write Calibration
            </button>
            <input type="file" id="calibFileInput" accept=".bin,.dat" style="display: none;">
            <button id="calibLoadFileBtn" class="secondary">
              <span class="icon">üìÇ</span>
              Load File
            </button>
            <button id="calibWriteFileBtn" class="secondary" disabled>
              <span class="icon">üíæ</span>
              Write File
            </button>
          </div>
          
          <div class="progress" id="calibProgress" style="display: none;">
            <div class="progress-label">
              <span id="calibStatus">Reading calibration...</span>
              <span id="calibPct">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="calibFill"></div>
            </div>
          </div>
          
          <!-- Squelch Calibration -->
          <h3 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="font-size: 1rem;">Squelch Calibration <span class="collapse-icon">‚ñº</span></h3>
          <div class="hidden" id="squelchCalibSection" style="padding: 0.5rem; background: var(--surface-2); border-radius: 8px; margin-bottom: 1rem;">
            <p class="muted" style="font-size: 0.85rem;">Configure squelch thresholds for different frequency bands.</p>
            
            <!-- Band Selection Tabs -->
            <div class="field-row" style="margin-bottom: 1rem;">
              <button class="tab-btn active" data-band="sqlBand4_7" onclick="switchSqlBand(this)">Band 4-7 (UHF)</button>
              <button class="tab-btn" data-band="sqlBand1_3" onclick="switchSqlBand(this)">Band 1-3 (VHF)</button>
            </div>
            
            <!-- Squelch Table -->
            <div style="overflow-x: auto;">
              <table class="calib-table" id="squelchTable">
                <thead>
                  <tr>
                    <th>SQL Level</th>
                    <th>Open RSSI</th>
                    <th>Close RSSI</th>
                    <th>Open Noise</th>
                    <th>Close Noise</th>
                    <th>Open Glitch</th>
                    <th>Close Glitch</th>
                  </tr>
                </thead>
                <tbody id="squelchTableBody">
                  <!-- Generated by JS -->
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- RSSI Levels Calibration -->
          <h3 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="font-size: 1rem;">RSSI Levels <span class="collapse-icon">‚ñº</span></h3>
          <div class="hidden" id="rssiCalibSection" style="padding: 0.5rem; background: var(--surface-2); border-radius: 8px; margin-bottom: 1rem;">
            <p class="muted" style="font-size: 0.85rem;">RSSI levels for the S-meter bar graph display.</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
              <!-- Bands 3-7 -->
              <div class="calib-group">
                <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Bands 3-7 (UHF)</h4>
                <div class="field-group">
                  <label>Level 1</label>
                  <input type="number" id="rssi37_level1" min="0" max="65535" value="0" class="calib-input">
                </div>
                <div class="field-group">
                  <label>Level 2</label>
                  <input type="number" id="rssi37_level2" min="0" max="65535" value="0" class="calib-input">
                </div>
                <div class="field-group">
                  <label>Level 4</label>
                  <input type="number" id="rssi37_level4" min="0" max="65535" value="0" class="calib-input">
                </div>
                <div class="field-group">
                  <label>Level 6</label>
                  <input type="number" id="rssi37_level6" min="0" max="65535" value="0" class="calib-input">
                </div>
              </div>
              
              <!-- Bands 1-2 -->
              <div class="calib-group">
                <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Bands 1-2 (VHF)</h4>
                <div class="field-group">
                  <label>Level 1</label>
                  <input type="number" id="rssi12_level1" min="0" max="65535" value="0" class="calib-input">
                </div>
                <div class="field-group">
                  <label>Level 2</label>
                  <input type="number" id="rssi12_level2" min="0" max="65535" value="0" class="calib-input">
                </div>
                <div class="field-group">
                  <label>Level 4</label>
                  <input type="number" id="rssi12_level4" min="0" max="65535" value="0" class="calib-input">
                </div>
                <div class="field-group">
                  <label>Level 6</label>
                  <input type="number" id="rssi12_level6" min="0" max="65535" value="0" class="calib-input">
                </div>
              </div>
            </div>
          </div>
          
          <!-- TX Power Calibration -->
          <h3 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="font-size: 1rem;">TX Power Calibration <span class="collapse-icon">‚ñº</span></h3>
          <div class="hidden" id="txPowerCalibSection" style="padding: 0.5rem; background: var(--surface-2); border-radius: 8px; margin-bottom: 1rem;">
            <p class="muted" style="font-size: 0.85rem;">Configure TX power levels for each frequency band.</p>
            
            <!-- Band Selection -->
            <div class="field-row" style="margin-bottom: 1rem; flex-wrap: wrap;">
              <button class="tab-btn active" data-txband="0" onclick="switchTxBand(this)">Band 1</button>
              <button class="tab-btn" data-txband="1" onclick="switchTxBand(this)">Band 2</button>
              <button class="tab-btn" data-txband="2" onclick="switchTxBand(this)">Band 3</button>
              <button class="tab-btn" data-txband="3" onclick="switchTxBand(this)">Band 4</button>
              <button class="tab-btn" data-txband="4" onclick="switchTxBand(this)">Band 5</button>
              <button class="tab-btn" data-txband="5" onclick="switchTxBand(this)">Band 6</button>
              <button class="tab-btn" data-txband="6" onclick="switchTxBand(this)">Band 7</button>
            </div>
            
            <!-- TX Power Table -->
            <div style="overflow-x: auto;">
              <table class="calib-table" id="txPowerTable">
                <thead>
                  <tr>
                    <th>Power Level</th>
                    <th>Lower</th>
                    <th>Center</th>
                    <th>Upper</th>
                  </tr>
                </thead>
                <tbody id="txPowerTableBody">
                  <tr>
                    <td><strong>Low</strong></td>
                    <td><input type="number" id="txp_low_lower" min="0" max="255" value="0" class="calib-input"></td>
                    <td><input type="number" id="txp_low_center" min="0" max="255" value="0" class="calib-input"></td>
                    <td><input type="number" id="txp_low_upper" min="0" max="255" value="0" class="calib-input"></td>
                  </tr>
                  <tr>
                    <td><strong>Medium</strong></td>
                    <td><input type="number" id="txp_mid_lower" min="0" max="255" value="0" class="calib-input"></td>
                    <td><input type="number" id="txp_mid_center" min="0" max="255" value="0" class="calib-input"></td>
                    <td><input type="number" id="txp_mid_upper" min="0" max="255" value="0" class="calib-input"></td>
                  </tr>
                  <tr>
                    <td><strong>High</strong></td>
                    <td><input type="number" id="txp_hi_lower" min="0" max="255" value="0" class="calib-input"></td>
                    <td><input type="number" id="txp_hi_center" min="0" max="255" value="0" class="calib-input"></td>
                    <td><input type="number" id="txp_hi_upper" min="0" max="255" value="0" class="calib-input"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Battery Calibration -->
          <h3 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="font-size: 1rem;">Battery Calibration <span class="collapse-icon">‚ñº</span></h3>
          <div class="hidden" id="batteryCalibSection" style="padding: 0.5rem; background: var(--surface-2); border-radius: 8px; margin-bottom: 1rem;">
            <p class="muted" style="font-size: 0.85rem;">Battery level thresholds. Level 3 is the voltage calibration reference.</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.5rem;">
              <div class="field-group">
                <label>Level 0</label>
                <input type="number" id="batLvl_0" min="0" max="4999" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 1</label>
                <input type="number" id="batLvl_1" min="0" max="4999" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 2</label>
                <input type="number" id="batLvl_2" min="0" max="4999" value="0" class="calib-input">
              </div>
              <div class="field-group" style="border: 1px solid var(--primary); padding: 0.3rem; border-radius: 4px;">
                <label style="color: var(--primary);">Level 3 (Voltage Cal)</label>
                <input type="number" id="batLvl_3" min="0" max="4999" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 4</label>
                <input type="number" id="batLvl_4" min="0" max="4999" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 5</label>
                <input type="number" id="batLvl_5" min="0" max="4999" value="0" class="calib-input">
              </div>
            </div>
          </div>
          
          <!-- VOX Calibration -->
          <h3 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="font-size: 1rem;">VOX Calibration <span class="collapse-icon">‚ñº</span></h3>
          <div class="hidden" id="voxCalibSection" style="padding: 0.5rem; background: var(--surface-2); border-radius: 8px; margin-bottom: 1rem;">
            <p class="muted" style="font-size: 0.85rem;">VOX sensitivity thresholds (On/Off).</p>
            
            <div style="overflow-x: auto;">
              <table class="calib-table" id="voxTable">
                <thead>
                  <tr>
                    <th>Level</th>
                    <th>VOX On (vox1Thr)</th>
                    <th>VOX Off (vox0Thr)</th>
                  </tr>
                </thead>
                <tbody id="voxTableBody">
                  <!-- Generated by JS -->
                </tbody>
              </table>
            </div>
          </div>
          
          <!-- Microphone Calibration -->
          <h3 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="font-size: 1rem;">Microphone Sensitivity <span class="collapse-icon">‚ñº</span></h3>
          <div class="hidden" id="micCalibSection" style="padding: 0.5rem; background: var(--surface-2); border-radius: 8px; margin-bottom: 1rem;">
            <p class="muted" style="font-size: 0.85rem;">Microphone sensitivity levels (0-31).</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 0.5rem;">
              <div class="field-group">
                <label>Level 0</label>
                <input type="number" id="micLevel_0" min="0" max="31" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 1</label>
                <input type="number" id="micLevel_1" min="0" max="31" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 2</label>
                <input type="number" id="micLevel_2" min="0" max="31" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 3</label>
                <input type="number" id="micLevel_3" min="0" max="31" value="0" class="calib-input">
              </div>
              <div class="field-group">
                <label>Level 4</label>
                <input type="number" id="micLevel_4" min="0" max="31" value="0" class="calib-input">
              </div>
            </div>
          </div>
          
          <!-- Other Calibration -->
          <h3 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="font-size: 1rem;">Other Calibration <span class="collapse-icon">‚ñº</span></h3>
          <div class="hidden" id="otherCalibSection" style="padding: 0.5rem; background: var(--surface-2); border-radius: 8px; margin-bottom: 1rem;">
            <p class="muted" style="font-size: 0.85rem;">Crystal frequency, volume and DAC gain settings.</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
              <div class="field-group">
                <label>Xtal Frequency Low</label>
                <input type="number" id="xtalFreqLow" min="-1000" max="1000" value="0" class="calib-input">
                <span class="hint" style="font-size: 0.75rem;">Range: -1000 to 1000</span>
              </div>
              <div class="field-group">
                <label>Volume Gain</label>
                <input type="number" id="volumeGain" min="0" max="63" value="58" class="calib-input">
                <span class="hint" style="font-size: 0.75rem;">Range: 0-63 (default: 58)</span>
              </div>
              <div class="field-group">
                <label>DAC Gain</label>
                <input type="number" id="dacGain" min="0" max="15" value="8" class="calib-input">
                <span class="hint" style="font-size: 0.75rem;">Range: 0-15 (default: 8)</span>
              </div>
            </div>
          </div>
          
          <p class="hint" style="margin-top: 1rem;">üí° Memory addresses: Calibration data is stored at 0x1E00-0x1F90 in EEPROM.</p>
        </section>


        <!-- HEX View Section -->
        <h2 class="section-title collapsible collapsed" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');">HEX View <span class="collapse-icon">‚ñº</span></h2>
        <section class="panel hidden" id="hexViewPanel">
          <p class="muted">Read and view EEPROM memory in hexadecimal format from radio or file.</p>
          
          <!-- Read from Radio -->
          <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
            <div class="field-group">
              <label for="hexStartAddr">Start Address</label>
              <input type="text" id="hexStartAddr" value="0x0000" placeholder="0x0000" style="width: 100px;">
            </div>
            <div class="field-group">
              <label for="hexLength">Length</label>
              <select id="hexLength">
                <option value="8192" selected>8 KB (64Kbit) (0x2000)</option>
                <option value="65536">64 KB (512Kbit) (0x10000)</option>
                <option value="131072">128 KB (1Mbit) (0x20000)</option>
                <option value="262144">256 KB (2Mbit) (0x40000)</option>
                <option value="524288">512 KB (4Mbit) (0x80000)</option>
              </select>
            </div>
            <div class="field-group" style="align-self: flex-end;">
              <button id="hexReadBtn" class="primary">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                  </svg>
                </span>
                Read from Radio
              </button>
            </div>
          </div>
          
          <!-- Load from File -->
          <div class="field-row" style="gap: 1rem; flex-wrap: wrap; padding-top: 1rem; border-top: 1px solid var(--border);">
            <div class="field-group">
              <label for="hexFileInput">Load .bin File</label>
              <input type="file" id="hexFileInput" accept=".bin,.eeprom,.dat" style="max-width: 250px;">
            </div>
            <div class="field-group">
              <label for="hexFileOffset">View Offset</label>
              <input type="text" id="hexFileOffset" value="0x0000" placeholder="0x0000" style="width: 100px;">
            </div>
            <div class="field-group">
              <label for="hexFileLength">View Length</label>
              <select id="hexFileLength">
                <option value="0">Entire File</option>
                <option value="8192">8 KB (0x2000)</option>
                <option value="65536">64 KB (0x10000)</option>
                <option value="131072">128 KB (0x20000)</option>
                <option value="262144">256 KB (0x40000)</option>
                <option value="524288">512 KB (0x80000)</option>
              </select>
            </div>
          </div>
          <div class="progress" style="margin: 1rem 0;">
            <div class="progress-label">
              <span id="hexStatus">Ready</span>
              <span id="hexPct">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="hexFill"></div>
            </div>
          </div>
          <div id="hexOutput" class="hex-view" style="font-family: 'Courier New', monospace; font-size: 12px; background: var(--surface-2); border-radius: 8px; padding: 1rem; overflow-x: auto; white-space: pre; max-height: 400px; overflow-y: auto; display: none;"></div>


          <!-- Developer Mode HEX View Tools -->
          <div style="border-top: 2px solid #f59e0b; margin-top: 2rem; padding-top: 1rem;">
            
            <!-- HEX View DEV - TK11 (Hidden until devmode) -->
            <h3 class="section-title collapsible collapsed dev-panel tk11-dev" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="color: #f59e0b; display: none; cursor: pointer; user-select: none;">üîß HEX View DEV (TK11) <span class="collapse-icon">‚ñº</span></h3>
            <section class="panel dev-panel tk11-dev hidden" id="hexViewDevTK11" style="display: none; border: 2px solid #f59e0b; margin-left: 1rem;">
                <p class="muted">Compare two files or a file with radio memory side by side.</p>
                
                <!-- Compare Options -->
                <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
                  <div class="field-group">
                    <label for="hexDevCompareModeTK11">Compare Mode</label>
                    <select id="hexDevCompareModeTK11">
                      <option value="files" selected>Two Files</option>
                      <option value="radio">File vs Radio</option>
                    </select>
                  </div>
                  <div class="field-group">
                    <label for="hexDevStartAddrTK11">Start Address (optional)</label>
                    <input type="text" id="hexDevStartAddrTK11" value="" placeholder="0x0000" style="width: 120px;">
                  </div>
                  <div class="field-group">
                    <label for="hexDevEndAddrTK11">End Address (optional)</label>
                    <input type="text" id="hexDevEndAddrTK11" value="" placeholder="Auto" style="width: 120px;">
                  </div>
                </div>
                
                <!-- File inputs -->
                <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem; padding: 1rem; background: var(--surface-2); border-radius: 8px;">
                  <div class="field-group" style="flex: 1;">
                    <label for="hexDevFile1TK11">üìÅ File 1 (Left)</label>
                    <input type="file" id="hexDevFile1TK11" accept=".bin,.eeprom,.dat">
                  </div>
                  <div class="field-group hexDevFile2GroupTK11" style="flex: 1;">
                    <label for="hexDevFile2TK11">üìÅ File 2 (Right)</label>
                    <input type="file" id="hexDevFile2TK11" accept=".bin,.eeprom,.dat">
                  </div>
                </div>
                
                <!-- Compare button -->
                <div class="field-row" style="gap: 1rem; margin-bottom: 1rem;">
                  <button id="hexDevCompareBtnTK11" style="background: #f59e0b;">
                    <span class="btn-icon" aria-hidden="true">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <path d="M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z"></path>
                        <path d="M15 3v4a2 2 0 0 0 2 2h4"></path>
                      </svg>
                    </span>
                    Compare
                  </button>
                  <button id="hexDevClearBtnTK11" style="background: #6b7280;">
                    Clear
                  </button>
                </div>
                
                <!-- Progress -->
                <div class="progress" id="hexDevProgressTK11" style="display: none;">
                  <div class="progress-label">
                    <span>Reading from radio...</span>
                    <span id="hexDevPctTK11">0%</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="hexDevFillTK11"></div>
                  </div>
                </div>
                
                <!-- Side by side comparison output -->
                <div id="hexDevOutputTK11" style="display: none;">
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                      <h4 style="color: #4ade80; margin-bottom: 0.5rem;">üìÑ <span id="hexDevFile1NameTK11">File 1</span></h4>
                      <div id="hexDevLeft_TK11" class="hex-view" style="font-family: 'Courier New', monospace; font-size: 11px; background: var(--surface-2); border-radius: 8px; padding: 0.5rem; overflow-x: auto; white-space: pre; max-height: 350px; overflow-y: auto;"></div>
                    </div>
                    <div>
                      <h4 style="color: #60a5fa; margin-bottom: 0.5rem;">üìÑ <span id="hexDevFile2NameTK11">File 2 / Radio</span></h4>
                      <div id="hexDevRight_TK11" class="hex-view" style="font-family: 'Courier New', monospace; font-size: 11px; background: var(--surface-2); border-radius: 8px; padding: 0.5rem; overflow-x: auto; white-space: pre; max-height: 350px; overflow-y: auto;"></div>
                    </div>
                  </div>
                  
                  <!-- Differences Console -->
                  <div style="border-top: 1px solid var(--border); padding-top: 1rem;">
                    <h4 style="color: #f59e0b; margin-bottom: 0.5rem;">üìã Differences Console</h4>
                    <div id="hexDevConsoleTK11" style="font-family: 'Courier New', monospace; font-size: 11px; background: #1a1a2e; color: #a2d2ff; border-radius: 8px; padding: 1rem; max-height: 200px; overflow-y: auto; white-space: pre-wrap;"></div>
                  </div>
                </div>
                
                <p class="hint" style="color: #f59e0b; margin-top: 1rem;">‚ö†Ô∏è Developer mode - differences are highlighted in red</p>
              </section>


            <!-- HEX View DEV - K5 (Hidden until devmode) -->
            <h3 class="section-title collapsible collapsed dev-panel k5-dev" onclick="this.classList.toggle('collapsed'); this.nextElementSibling.classList.toggle('hidden');" style="color: #f59e0b; display: none; cursor: pointer; user-select: none; margin-top: 1.5rem;">üîß HEX View DEV (K5) <span class="collapse-icon">‚ñº</span></h3>
            <section class="panel dev-panel k5-dev hidden" id="hexViewDevK5" style="display: none; border: 2px solid #f59e0b; margin-left: 1rem;">
                <p class="muted">Compare two files or a file with radio memory side by side.</p>
                
                <!-- Compare Options -->
                <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem;">
                  <div class="field-group">
                    <label for="hexDevCompareModeK5">Compare Mode</label>
                    <select id="hexDevCompareModeK5">
                      <option value="files" selected>Two Files</option>
                      <option value="radio">File vs Radio</option>
                    </select>
                  </div>
                  <div class="field-group">
                    <label for="hexDevStartAddrK5">Start Address (optional)</label>
                    <input type="text" id="hexDevStartAddrK5" value="" placeholder="0x0000" style="width: 120px;">
                  </div>
                  <div class="field-group">
                    <label for="hexDevEndAddrK5">End Address (optional)</label>
                    <input type="text" id="hexDevEndAddrK5" value="" placeholder="Auto" style="width: 120px;">
                  </div>
                </div>
                
                <!-- File inputs -->
                <div class="field-row" style="gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem; padding: 1rem; background: var(--surface-2); border-radius: 8px;">
                  <div class="field-group" style="flex: 1;">
                    <label for="hexDevFile1K5">üìÅ File 1 (Left)</label>
                    <input type="file" id="hexDevFile1K5" accept=".bin,.eeprom,.dat">
                  </div>
                  <div class="field-group hexDevFile2GroupK5" style="flex: 1;">
                    <label for="hexDevFile2K5">üìÅ File 2 (Right)</label>
                    <input type="file" id="hexDevFile2K5" accept=".bin,.eeprom,.dat">
                  </div>
                </div>
                
                <!-- Compare button -->
                <div class="field-row" style="gap: 1rem; margin-bottom: 1rem;">
                  <button id="hexDevCompareBtnK5" style="background: #f59e0b;">
                    <span class="btn-icon" aria-hidden="true">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <path d="M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z"></path>
                        <path d="M15 3v4a2 2 0 0 0 2 2h4"></path>
                      </svg>
                    </span>
                    Compare
                  </button>
                  <button id="hexDevClearBtnK5" style="background: #6b7280;">
                    Clear
                  </button>
                </div>
                
                <!-- Progress -->
                <div class="progress" id="hexDevProgressK5" style="display: none;">
                  <div class="progress-label">
                    <span>Reading from radio...</span>
                    <span id="hexDevPctK5">0%</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="hexDevFillK5"></div>
                  </div>
                </div>
                
                <!-- Side by side comparison output -->
                <div id="hexDevOutputK5" style="display: none;">
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <div>
                      <h4 style="color: #4ade80; margin-bottom: 0.5rem;">üìÑ <span id="hexDevFile1NameK5">File 1</span></h4>
                      <div id="hexDevLeft_K5" class="hex-view" style="font-family: 'Courier New', monospace; font-size: 11px; background: var(--surface-2); border-radius: 8px; padding: 0.5rem; overflow-x: auto; white-space: pre; max-height: 350px; overflow-y: auto;"></div>
                    </div>
                    <div>
                      <h4 style="color: #60a5fa; margin-bottom: 0.5rem;">üìÑ <span id="hexDevFile2NameK5">File 2 / Radio</span></h4>
                      <div id="hexDevRight_K5" class="hex-view" style="font-family: 'Courier New', monospace; font-size: 11px; background: var(--surface-2); border-radius: 8px; padding: 0.5rem; overflow-x: auto; white-space: pre; max-height: 350px; overflow-y: auto;"></div>
                    </div>
                  </div>
                  
                  <!-- Differences Console -->
                  <div style="border-top: 1px solid var(--border); padding-top: 1rem;">
                    <h4 style="color: #f59e0b; margin-bottom: 0.5rem;">üìã Differences Console</h4>
                    <div id="hexDevConsoleK5" style="font-family: 'Courier New', monospace; font-size: 11px; background: #1a1a2e; color: #a2d2ff; border-radius: 8px; padding: 1rem; max-height: 200px; overflow-y: auto; white-space: pre-wrap;"></div>
                  </div>
                </div>
                
                <p class="hint" style="color: #f59e0b; margin-top: 1rem;">‚ö†Ô∏è Developer mode - differences are highlighted in red</p>
              </section>
          </div>
        </section>

        
        

<div id="log" class="log-area"></div>
      </section>

      <!-- Channel Editor Page -->
      <section class="page" id="channels" data-page>
        <header class="hero">
          <div>
            <p class="eyebrow" id="channelsEyebrow">CHANNELS TOOLS</p>
            <h1>Channel editor.</h1>
            <p class="subtitle">Read, edit and write channels to the radio.</p>
            <div class="k5-only" style="margin-top: 0.75rem;">
              <label for="channelProfileSelect" style="font-size: 0.85rem; color: var(--muted); margin-right: 0.5rem;">Channel Profile:</label>
              <select id="channelProfileSelect" style="padding: 0.4rem 0.8rem; border-radius: 6px; background: var(--card); color: var(--text); border: 1px solid var(--border); font-size: 0.85rem;">
                <option value="default200">Default 200 Channels</option>
                <option value="f4hwn_v43">F4HWN v4.3 (200 Channels)</option>
                <option value="ijv_vx3">IJV_vX3xx (999 Channels)</option>
              </select>
            </div>
            <p class="subtitle muted tk11-only" style="font-size: 0.9rem; margin-top: 0.5rem; display: none;">TK11: 999 Channels</p>
          </div>
          <div class="status-card status-split">
            <div class="status-main">
              <div class="status-top">
                <span class="status-dot" id="channelsStatusDot" data-status="disconnected"></span>
                <span id="channelsStatusLabel">Disconnected</span>
              </div>
              <p id="channelsFirmware" class="muted">-</p>
              <div class="status-actions">
                <button id="readChannelsBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M3 12h4l3-9 4 18 3-9h4" />
                    </svg>
                  </span>
                  Read channels
                </button>
                <button id="writeChannelsBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M12 3v12" />
                      <path d="M17 8l-5 5-5-5" />
                      <path d="M5 21h14" />
                    </svg>
                  </span>
                  Write channels
                </button>
              </div>
            </div>
          </div>
        </header>

        <div class="toolbar">
          <div class="toolbar-left">
            <input type="text" id="channelSearch" placeholder="Search channels..." class="search-input" />
            <button id="exportCsvBtn" class="secondary" title="Export to CSV">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                  <polyline points="7 10 12 15 17 10" />
                  <line x1="12" y1="15" x2="12" y2="3" />
                </svg>
              </span>
              Export CSV
            </button>
            <button id="importCsvBtn" class="secondary" title="Import from CSV">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                  <polyline points="17 8 12 3 7 8" />
                  <line x1="12" y1="3" x2="12" y2="15" />
                </svg>
              </span>
              Import CSV
            </button>
          </div>
          <div class="toolbar-right">
            <div class="view-toggle">
              <button id="viewPagesBtn" class="active">Pages</button>
              <button id="viewAllBtn">All</button>
            </div>
<div id="paginationControls" class="pagination-controls">
              <span id="pageInfo" class="page-info">1-50 of 200</span>
              <button id="prevPageBtn" class="pagination-btn" title="Previous page">‚Üê</button>
              <div id="pageLinks" class="pagination"></div>
              <button id="nextPageBtn" class="pagination-btn" title="Next page">‚Üí</button>
            </div>
          </div>
        </div>

        <div class="channel-status">
          <span id="channelStatus">Idle.</span>
          <div class="progress" id="channelProgress">
            <div class="progress-label">
              <span>Progress&nbsp;</span>
              <span id="channelPct">0%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" id="channelFill"></div>
            </div>
          </div>
        </div>

        <div class="table-wrap">
          <table class="data-table" id="channelTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Name</th>
                <th>RX Freq</th>
                <th>TX Freq</th>
                <th>Mod</th>
                <th>BW</th>
                <th>Power</th>
                <th>RX Tone</th>
                <th>TX Tone</th>
                <th>Step</th>
                <th>Scrambler</th>
                <th>List</th>
              </tr>
            </thead>
            <tbody id="channelBody"></tbody>
          </table>
        </div>

        <div class="progress" style="margin-top: 1rem;">
          <div class="progress-label">
            <span id="channelsStatus">Idle</span>
            <span id="channelsPct">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="channelsFill"></div>
          </div>
        </div>
      </section>

      <!-- Basic Settings Page -->
      <section class="page" id="settings" data-page>
        <header class="hero">
          <div>
            <p class="eyebrow">SETTINGS TOOLS</p>
            <h1>Basic settings editor.</h1>
            <p class="subtitle">Read and write settings from the radio.</p>
            <p class="warning" style="color: #f59e0b; font-weight: 600; margin-top: 0.5rem;">‚ö†Ô∏è Work in progress. Do not use yet.</p>
          </div>
          <div class="status-card status-split">
            <div class="status-main">
              <div class="status-top">
                <span class="status-dot" id="settingsStatusDot" data-status="disconnected"></span>
                <span id="settingsStatusLabel">Disconnected</span>
              </div>
              <p id="settingsFirmware" class="muted">-</p>
              <div class="status-actions">
                <button id="readSettingsBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M3 12h4l3-9 4 18 3-9h4" />
                    </svg>
                  </span>
                  Read settings
                </button>
                <button id="writeSettingsBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M12 3v12" />
                      <path d="M17 8l-5 5-5-5" />
                      <path d="M5 21h14" />
                    </svg>
                  </span>
                  Write settings
                </button>
              </div>
            </div>
          </div>
        </header>

        <!-- Settings Tabs -->
        <div class="settings-tabs-container" style="margin-bottom: 1.5rem;">
          <div class="settings-tabs">
            <button class="tab-btn active" data-tab="firmware-profile">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
              </svg>
              Firmware Profile (Work in progress. Do not use yet.)
            </button>
            <button class="tab-btn" data-tab="dtmf-contacts">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                <path d="M9 9h.01M15 9h.01M9 15h.01M15 15h.01M12 12h.01"></path>
              </svg>
              DTMF Contacts
            </button>
            <button class="tab-btn" data-tab="radio-fm">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polygon points="10 8 16 12 10 16 10 8"></polygon>
              </svg>
              Radio FM
            </button>
          </div>
          
          <!-- Tab 1: Firmware Profile -->
          <div class="tab-content active" id="tab-firmware-profile">
            <h3>Firmware Profile</h3>
            <p class="muted">Select the firmware profile to use for settings.</p>
            <div class="field-group" style="max-width: 300px; margin-top: 1rem;">
              <label for="firmwareProfile">Profile</label>
              <select id="firmwareProfile">
                <!-- Options populated by JavaScript -->
              </select>
            </div>
          </div>
          
          <!-- Tab 2: DTMF Contacts -->
          <div class="tab-content" id="tab-dtmf-contacts">
            <h3>DTMF Contacts</h3>
            <p class="muted">Manage DTMF contacts stored in the radio (EEPROM: 0x1C00 - 0x1D00).</p>
            
            <div class="dtmf-actions">
              <button id="dtmfReadBtn" class="primary">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                  </svg>
                </span>
                Read DTMF
              </button>
              <button id="dtmfWriteBtn">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                  </svg>
                </span>
                Write DTMF
              </button>
              <button id="dtmfClearAllBtn" class="ghost">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  </svg>
                </span>
                Clear All
              </button>
            </div>
            
            <table class="dtmf-table">
              <thead>
                <tr>
                  <th class="index-col">#</th>
                  <th>Name (8 chars)</th>
                  <th>DTMF ID (0-9, A-D, *, #)</th>
                  <th style="width: 60px;"></th>
                </tr>
              </thead>
              <tbody id="dtmfTableBody">
                <!-- DTMF rows will be generated by JavaScript -->
              </tbody>
            </table>
          </div>
          
          <!-- Tab 3: Radio FM Frequencies -->
          <div class="tab-content" id="tab-radio-fm">
            <h3>Radio (FM Frequencies)</h3>
            <p class="muted">Quick frequency memory slots (EEPROM: 0x0E40 - 0x0E68).</p>
            
            <div class="radio-actions">
              <button id="radioReadBtn" class="primary">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                  </svg>
                </span>
                Read Radio
              </button>
              <button id="radioWriteBtn">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                  </svg>
                </span>
                Write Radio
              </button>
              <button id="radioClearAllBtn" class="ghost">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  </svg>
                </span>
                Clear All
              </button>
            </div>
            
            <table class="radio-table">
              <thead>
                <tr>
                  <th class="index-col">#</th>
                  <th>RX Frequency (MHz)</th>
                  <th style="width: 60px;"></th>
                </tr>
              </thead>
              <tbody id="radioTableBody">
                <!-- Radio FM rows will be generated by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>

        <div class="progress">
          <div class="progress-label">
            <span id="settingsStatus">Idle</span>
            <span id="settingsPct">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="settingsFill"></div>
          </div>
        </div>

        <div id="settingsPanel" class="settings-table is-locked">
          <!-- Profile-specific settings will be dynamically inserted here -->
          <div id="profileSettings">
            <p class="muted">Select a firmware profile and click "Read Settings" to load settings from your radio.</p>
          </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal" aria-hidden="true">
          <div class="modal-content">
            <h3 id="settingsModalTitle">Processing</h3>
            <p id="settingsModalMessage">Please keep the radio connected.</p>
            <div class="progress">
              <div class="progress-bar">
                <div class="progress-fill" id="settingsModalFill"></div>
              </div>
              <div class="progress-label">
                <span id="settingsModalPct">0%</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ============================================ -->
      <!-- TK11 SETTINGS PAGE                           -->
      <!-- ============================================ -->
      <section class="page tk11-only" id="tk11-settings" data-page style="display: none;">
        <header class="hero">
          <div>
            <p class="eyebrow">TK11 SETTINGS</p>
            <h1>TK11 Settings</h1>
            <p class="subtitle">Configure TK11 radio settings.</p>
            
          </div>
        </header>

        <!-- Status Card -->
        <div class="status-card status-split tk11-status-card">
          <div class="status-main">
            <div class="status-top">
              <span class="status-dot" id="tk11SettingsStatusDot" data-status="disconnected"></span>
              <span id="tk11SettingsStatusLabel">Not connected</span>
            </div>
            <p id="tk11SettingsFirmware" class="muted">-</p>
            <div class="status-actions">
              <button id="tk11ReadAllSettingsBtn" class="primary" disabled>
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                  </svg>
                </span>
                Read All Settings
              </button>
              <button id="tk11WriteAllSettingsBtn" disabled>
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                  </svg>
                </span>
                Write All Settings
              </button>
            </div>
          </div>
          <div class="progress-bar" style="margin-top: 0.5rem;">
            <div class="progress-fill" id="tk11SettingsFill"></div>
          </div>
        </div>

        <section class="panel">
          <!-- TK11 Settings Tabs -->
          <div class="settings-tabs-container tk11-settings-tabs" style="margin-bottom: 1.5rem;">
                        <div class="settings-tabs">
              <button class="tab-btn active" data-tab="tk11-general">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <circle cx="12" cy="12" r="3" />
                  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06" />
                </svg>
                General
              </button>
              <button class="tab-btn" data-tab="tk11-buttons">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <rect x="3" y="8" width="18" height="8" rx="2"></rect>
                  <circle cx="8" cy="12" r="1"></circle>
                  <circle cx="16" cy="12" r="1"></circle>
                </svg>
                Buttons
              </button>
              <button class="tab-btn" data-tab="tk11-startup">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                Startup
              </button>
              <button class="tab-btn" data-tab="tk11-channel">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M2 12h4l3 9 4-18 3 9h4"></path>
                </svg>
                Channel
              </button>
              <button class="tab-btn" data-tab="tk11-match">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M2 12h4l3-9 4 18 3-9h4"></path>
                </svg>
                Match Freq
              </button>
              <button class="tab-btn" data-tab="tk11-noaa">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <path d="M12 6v6l4 2"></path>
                </svg>
                NOAA
              </button>
              <button class="tab-btn" data-tab="tk11-dtmf">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                  <path d="M9 9h.01M15 9h.01M9 15h.01M15 15h.01M12 12h.01"></path>
                </svg>
                DTMF
              </button>
              <button class="tab-btn" data-tab="tk11-5tone">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M9 18V5l12-2v13"></path>
                  <circle cx="6" cy="18" r="3"></circle>
                  <circle cx="18" cy="16" r="3"></circle>
                </svg>
                5TONE
              </button>
              <button class="tab-btn" data-tab="tk11-fm">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polygon points="10 8 16 12 10 16 10 8"></polygon>
                </svg>
                Radio FM
              </button>
              <button class="tab-btn" data-tab="tk11-logo">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                  <circle cx="8.5" cy="8.5" r="1.5"></circle>
                  <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                Logo Editor
              </button>
            </div>
            
            <!-- Tab 1: General -->
            <div class="tab-content active" id="tab-tk11-general">
              <h3>General Settings</h3>
              <p class="muted">Configure general radio parameters.</p>
              
              <div class="tk11-settings-actions" style="margin: 1rem 0;">
                <button id="tk11GeneralReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read
                </button>
                <button id="tk11GeneralWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write
                </button>
              </div>
              
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk11TOT">TOT (minutes)</label>
                  <select id="tk11TOT">
                    <option value="0">Off</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11VOX">VOX</label>
                  <select id="tk11VOX">
                    <option value="0">Off</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11Mic">Microphone</label>
                  <select id="tk11Mic">
                    <option value="0">1</option>
                    <option value="1">2</option>
                    <option value="2">3</option>
                    <option value="3">4</option>
                    <option value="4">5</option>
                    <option value="5">6</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11Backlight">Backlight</label>
                  <select id="tk11Backlight">
                    <option value="0">Off</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">10</option>
                    <option value="7">15</option>
                    <option value="8">20</option>
                    <option value="9">25</option>
                    <option value="10">30</option>
                    <option value="11">Always ON</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11Brightness">Brightness (8-200)</label>
                  <input type="number" id="tk11Brightness" min="8" max="200" value="100">
                </div>
                
                <div class="field-group">
                  <label for="tk11ScanMode">Scan Mode</label>
                  <select id="tk11ScanMode">
                    <option value="0">TO</option>
                    <option value="1">CO</option>
                    <option value="2">SE</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11PowerOnMode">Power ON Mode</label>
                  <select id="tk11PowerOnMode">
                    <option value="0">Off</option>
                    <option value="1">1:1</option>
                    <option value="2">1:2</option>
                    <option value="3">1:3</option>
                    <option value="4">1:4</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11Alarm">Alarm</label>
                  <select id="tk11Alarm">
                    <option value="0">Local alarm</option>
                    <option value="1">Remote alarm</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11Respond">Respond</label>
                  <select id="tk11Respond">
                    <option value="0">OFF</option>
                    <option value="1">Remind</option>
                    <option value="2">Reply</option>
                    <option value="3">Remind & reply</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11CWPitch">CW Pitch Freq (400-1500)</label>
                  <input type="number" id="tk11CWPitch" min="400" max="1500" step="10" value="700">
                </div>
              </div>
              
              <div class="tk11-checkboxes" style="margin-top: 1.5rem;">
                <h4 style="margin-bottom: 0.75rem;">Options</h4>
                <div class="checkbox-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 0.5rem;">
                  <label class="checkbox-label"><input type="checkbox" id="tk11Beep"> Beep Tone</label>
                  <label class="checkbox-label"><input type="checkbox" id="tk11Voice"> Voice</label>
                  <label class="checkbox-label"><input type="checkbox" id="tk11SBar"> S-Bar</label>
                  <label class="checkbox-label"><input type="checkbox" id="tk11KillCode"> Kill Code</label>
                  <label class="checkbox-label"><input type="checkbox" id="tk11SideTone"> Side Tone</label>
                  <label class="checkbox-label"><input type="checkbox" id="tk11MwSwAGC"> MwSw AGC</label>
                </div>
              </div>
            </div>
            
            <!-- Tab 2: Buttons -->
            <div class="tab-content" id="tab-tk11-buttons">
              <h3>Buttons Settings</h3>
              <p class="muted">Configure side key actions and key lock behavior.</p>
              
              <div class="tk11-settings-actions" style="margin: 1rem 0;">
                <button id="tk11ButtonsReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read
                </button>
                <button id="tk11ButtonsWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write
                </button>
              </div>
              
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk11SideKey1Short">Side Key 1 Short Press</label>
                  <select id="tk11SideKey1Short">
                    <option value="0">None</option>
                    <option value="1">Flashlight</option>
                    <option value="2">Power selection</option>
                    <option value="3">Monitor</option>
                    <option value="4">Scan</option>
                    <option value="5">VOX</option>
                    <option value="6">Alarm</option>
                    <option value="7">FM radio</option>
                    <option value="8">1750 MHz</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11SideKey1Long">Side Key 1 Long Press</label>
                  <select id="tk11SideKey1Long">
                    <option value="0">None</option>
                    <option value="1">Flashlight</option>
                    <option value="2">Power selection</option>
                    <option value="3">Monitor</option>
                    <option value="4">Scan</option>
                    <option value="5">VOX</option>
                    <option value="6">Alarm</option>
                    <option value="7">FM radio</option>
                    <option value="8">1750 MHz</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11SideKey2Short">Side Key 2 Short Press</label>
                  <select id="tk11SideKey2Short">
                    <option value="0">None</option>
                    <option value="1">Flashlight</option>
                    <option value="2">Power selection</option>
                    <option value="3">Monitor</option>
                    <option value="4">Scan</option>
                    <option value="5">VOX</option>
                    <option value="6">Alarm</option>
                    <option value="7">FM radio</option>
                    <option value="8">1750 MHz</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11SideKey2Long">Side Key 2 Long Press</label>
                  <select id="tk11SideKey2Long">
                    <option value="0">None</option>
                    <option value="1">Flashlight</option>
                    <option value="2">Power selection</option>
                    <option value="3">Monitor</option>
                    <option value="4">Scan</option>
                    <option value="5">VOX</option>
                    <option value="6">Alarm</option>
                    <option value="7">FM radio</option>
                    <option value="8">1750 MHz</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11KeyLock">Key Lock</label>
                  <select id="tk11KeyLock">
                    <option value="0">Unlocked</option>
                    <option value="1">Locked</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label class="checkbox-label" style="margin-top: 1.5rem;">
                    <input type="checkbox" id="tk11AutoLock"> Auto Lock
                  </label>
                </div>
              </div>
            </div>
            
            <!-- Tab 3: Startup -->
            <div class="tab-content" id="tab-tk11-startup">
              <h3>Startup Settings</h3>
              <p class="muted">Configure boot screen and display options.</p>
              
              <div class="tk11-settings-actions" style="margin: 1rem 0;">
                <button id="tk11StartupReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read
                </button>
                <button id="tk11StartupWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write
                </button>
              </div>
              
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk11DeviceName">Device Name (12 chars max)</label>
                  <input type="text" id="tk11DeviceName" maxlength="12" placeholder="TK11">
                </div>
                
                <div class="field-group">
                  <label for="tk11StartString1">Start String 1 (15 chars max)</label>
                  <input type="text" id="tk11StartString1" maxlength="15" placeholder="">
                </div>
                
                <div class="field-group">
                  <label for="tk11StartString2">Start String 2 (15 chars max)</label>
                  <input type="text" id="tk11StartString2" maxlength="15" placeholder="">
                </div>
                
                <div class="field-group">
                  <label for="tk11BootScreen">Boot Screen</label>
                  <select id="tk11BootScreen">
                    <option value="0">Fullscreen</option>
                    <option value="1">Welcome</option>
                    <option value="2">Battery voltage</option>
                    <option value="3">Picture</option>
                    <option value="4">None</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11ADisplay">A Display</label>
                  <select id="tk11ADisplay">
                    <option value="0">A-F01</option>
                    <option value="1">A-F02</option>
                    <option value="2">A-F03</option>
                    <option value="3">A-F04</option>
                    <option value="4">A-F05</option>
                    <option value="5">A-F06</option>
                    <option value="6">A-F07</option>
                    <option value="7">A-F08</option>
                    <option value="8">A-F09</option>
                    <option value="9">A-F10</option>
                    <option value="10">A-F11</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11BDisplay">B Display</label>
                  <select id="tk11BDisplay">
                    <option value="0">B-F01</option>
                    <option value="1">B-F02</option>
                    <option value="2">B-F03</option>
                    <option value="3">B-F04</option>
                    <option value="4">B-F05</option>
                    <option value="5">B-F06</option>
                    <option value="6">B-F07</option>
                    <option value="7">B-F08</option>
                    <option value="8">B-F09</option>
                    <option value="9">B-F10</option>
                    <option value="10">B-F11</option>
                  </select>
                </div>
              </div>
            </div>
            
            <!-- Tab 4: Channel -->
            <div class="tab-content" id="tab-tk11-channel">
              <h3>Channel Settings</h3>
              <p class="muted">Configure channel and audio parameters.</p>
              
              <div class="tk11-settings-actions" style="margin: 1rem 0;">
                <button id="tk11ChannelReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read
                </button>
                <button id="tk11ChannelWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write
                </button>
              </div>
              
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk11MainChannel">Main Channel</label>
                  <select id="tk11MainChannel">
                    <option value="0">A</option>
                    <option value="1">B</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11VolumeA">Volume RX Balance A</label>
                  <select id="tk11VolumeA">
                    <option value="0">0%</option>
                    <option value="1">33%</option>
                    <option value="2">66%</option>
                    <option value="3">100%</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11VolumeB">Volume RX Balance B</label>
                  <select id="tk11VolumeB">
                    <option value="0">0%</option>
                    <option value="1">33%</option>
                    <option value="2">66%</option>
                    <option value="3">100%</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11ChannelDisplayMode">Channel Display Mode</label>
                  <select id="tk11ChannelDisplayMode">
                    <option value="0">Frequency</option>
                    <option value="1">ID</option>
                    <option value="2">Name</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11RepeaterTail">Repeater Tail Tone</label>
                  <select id="tk11RepeaterTail">
                    <option value="0">OFF</option>
                    <option value="1">100</option>
                    <option value="2">200</option>
                    <option value="3">300</option>
                    <option value="4">400</option>
                    <option value="5">500</option>
                    <option value="6">600</option>
                    <option value="7">700</option>
                    <option value="8">800</option>
                    <option value="9">900</option>
                    <option value="10">1000</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11RemindEOT">Remind End of Talk</label>
                  <select id="tk11RemindEOT">
                    <option value="0">OFF</option>
                    <option value="1">Beep tone</option>
                    <option value="2">MDC</option>
                    <option value="3">User1</option>
                    <option value="4">User2</option>
                    <option value="5">User3</option>
                    <option value="6">User4</option>
                    <option value="7">User5</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11Denoise">Denoise</label>
                  <select id="tk11Denoise">
                    <option value="0">OFF</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                  </select>
                  <input type="hidden" id="tk11DenoiseLvl" value="0">
                </div>
                
                <div class="field-group">
                  <label for="tk11Transpositional">Transpositional</label>
                  <select id="tk11Transpositional">
                    <option value="0">OFF</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                  </select>
                  <input type="hidden" id="tk11TranspositionalLvl" value="0">
                </div>
              </div>
              
              <div class="tk11-checkboxes" style="margin-top: 1.5rem;">
                <h4 style="margin-bottom: 0.75rem;">Options</h4>
                <div class="checkbox-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 0.5rem;">
                  <label class="checkbox-label"><input type="checkbox" id="tk11VFOMode"> VFO Mode</label>
                  <label class="checkbox-label"><input type="checkbox" id="tk11TailTone"> Tail Tone</label>
                  <label class="checkbox-label"><input type="checkbox" id="tk11DualReceive"> Dual Receive</label>
                </div>
              </div>
            </div>
                        
            <!-- Tab 5: Match Frequency -->
            <div class="tab-content" id="tab-tk11-match">
              <h3>Match Frequency Settings</h3>
              <p class="muted">Configure frequency matching parameters.</p>
              
              <div class="tk11-settings-actions" style="margin: 1rem 0;">
                <button id="tk11MatchReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read
                </button>
                <button id="tk11MatchWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write
                </button>
              </div>
              
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk11FreqMeterTOT">Frequency Meter TOT (8-32s)</label>
                  <input type="number" id="tk11FreqMeterTOT" min="8" max="32" value="16">
                </div>
                
                <div class="field-group">
                  <label for="tk11FreqMeterMode">Frequency Meter Mode</label>
                  <select id="tk11FreqMeterMode">
                    <option value="0">Normal</option>
                    <option value="1">Expert mode</option>
                    <option value="2">Auto learning mode</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11MatchDCS">DCS</label>
                  <select id="tk11MatchDCS">
                    <option value="0">23bit</option>
                    <option value="1">24bit</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11MatchThreshold">QT Threshold (10-200)</label>
                  <input type="number" id="tk11MatchThreshold" min="10" max="200" value="100">
                </div>
              </div>
            </div>
            
            <!-- Tab 6: NOAA -->
            <div class="tab-content" id="tab-tk11-noaa">
              <h3>NOAA Settings</h3>
              <p class="muted">Configure NOAA weather alert settings.</p>
              
              <div class="tk11-settings-actions" style="margin: 1rem 0;">
                <button id="tk11NOAAReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read
                </button>
                <button id="tk11NOAAWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write
                </button>
              </div>
              
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk11NOAASameDecode">NOAA SAME Decode</label>
                  <select id="tk11NOAASameDecode">
                    <option value="0">Null</option>
                    <option value="1">1050Hz</option>
                    <option value="2">SAME decode</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11NOAASameEvent">NOAA SAME Event</label>
                  <select id="tk11NOAASameEvent">
                    <option value="0">Default</option>
                    <option value="1">All open</option>
                    <option value="2">All off</option>
                    <option value="3">User</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11NOAASameAddress">NOAA SAME Address</label>
                  <select id="tk11NOAASameAddress">
                    <option value="0">Single address</option>
                    <option value="1">Multiple address</option>
                    <option value="2">Any address</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11NOAASQ">NOAA SQ (0-9)</label>
                  <input type="number" id="tk11NOAASQ" min="0" max="9" value="0">
                </div>
                
                <div class="field-group">
                  <label for="tk11NOAAScan">NOAA Search</label>
                  <select id="tk11NOAAScan">
                    <option value="0">Manual</option>
                    <option value="1">Auto</option>
                  </select>
                </div>
              </div>
            </div>
            
            <!-- Tab 7: DTMF Settings -->
            <div class="tab-content" id="tab-tk11-dtmf">
              <h3>DTMF Settings</h3>
              <p class="muted">Configure DTMF signaling parameters and contacts (EEPROM: 0x1A000).</p>
              
              <div class="dtmf-actions">
                <button id="tk11DTMFReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read DTMF
                </button>
                <button id="tk11DTMFWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write DTMF
                </button>
              </div>
              
              <!-- DTMF Settings Grid -->
              <h4 style="margin-top: 1.5rem; margin-bottom: 1rem;">DTMF Parameters</h4>
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk11DTMFLocalCode">Local Code (3 digits)</label>
                  <input type="text" id="tk11DTMFLocalCode" maxlength="3" placeholder="000" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFKillCode">Kill Code (5 digits)</label>
                  <input type="text" id="tk11DTMFKillCode" maxlength="5" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFReviveCode">Revive Code (5 digits)</label>
                  <input type="text" id="tk11DTMFReviveCode" maxlength="5" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFSeparateCode">Separate Code</label>
                  <select id="tk11DTMFSeparateCode">
                    <option value="0">Null</option>
                    <option value="1">A</option>
                    <option value="2">B</option>
                    <option value="3">C</option>
                    <option value="4">D</option>
                    <option value="5">*</option>
                    <option value="6">#</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFGroupCode">Group Code</label>
                  <select id="tk11DTMFGroupCode">
                    <option value="0">A</option>
                    <option value="1">B</option>
                    <option value="2">C</option>
                    <option value="3">D</option>
                    <option value="4">*</option>
                    <option value="5">#</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFAutoResetTime">Auto Reset Time (5-60s)</label>
                  <input type="number" id="tk11DTMFAutoResetTime" min="5" max="60" value="10">
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFUpCode">Up Code (14 chars)</label>
                  <input type="text" id="tk11DTMFUpCode" maxlength="14" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFDownCode">Down Code (14 chars)</label>
                  <input type="text" id="tk11DTMFDownCode" maxlength="14" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFPreLoadTime">Pre Load Time (ms)</label>
                  <select id="tk11DTMFPreLoadTime">
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFFirstCodePersist">First Code Persist (ms)</label>
                  <select id="tk11DTMFFirstCodePersist">
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFCodePersist">Code Persist Time (ms)</label>
                  <select id="tk11DTMFCodePersist">
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFCodeContinue">Code Continue Time (ms)</label>
                  <select id="tk11DTMFCodeContinue">
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk11DTMFCodeInterval">Code Interval Time (ms)</label>
                  <select id="tk11DTMFCodeInterval">
                  </select>
                </div>
              </div>
              
              <!-- DTMF Contacts Table -->
              <h4 style="margin-top: 2rem; margin-bottom: 1rem;">DTMF Contacts</h4>
              <button id="tk11DTMFClearBtn" class="ghost" style="margin-bottom: 1rem;">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  </svg>
                </span>
                Clear All Contacts
              </button>
              
              <table class="dtmf-table">
                <thead>
                  <tr>
                    <th class="index-col">#</th>
                    <th>Name (8 chars)</th>
                    <th>Code ID (3 chars)</th>
                    <th style="width: 60px;"></th>
                  </tr>
                </thead>
                <tbody id="tk11DTMFTableBody">
                  <!-- 16 DTMF contacts will be generated by JavaScript -->
                </tbody>
              </table>
            </div>
            
            <!-- Tab 8: 5TONE Settings -->
            <div class="tab-content" id="tab-tk11-5tone">
              <h3>5TONE Settings</h3>
              <p class="muted">Configure 5-Tone signaling parameters and contacts (EEPROM: 0x1A800).</p>
              
              <div class="dtmf-actions">
                <button id="tk115ToneReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read 5TONE
                </button>
                <button id="tk115ToneWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write 5TONE
                </button>
              </div>
              
              <!-- 5TONE Settings Grid -->
              <h4 style="margin-top: 1.5rem; margin-bottom: 1rem;">5TONE Parameters</h4>
              <div class="tk11-settings-grid">
                <div class="field-group">
                  <label for="tk115ToneLocalCode">Local Code (3 digits)</label>
                  <input type="text" id="tk115ToneLocalCode" maxlength="3" placeholder="000" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneKillCode">Kill Code (5 digits)</label>
                  <input type="text" id="tk115ToneKillCode" maxlength="5" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneReviveCode">Revive Code (5 digits)</label>
                  <input type="text" id="tk115ToneReviveCode" maxlength="5" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneSeparateCode">Separate Code</label>
                  <select id="tk115ToneSeparateCode">
                    <option value="0">A</option>
                    <option value="1">B</option>
                    <option value="2">C</option>
                    <option value="3">D</option>
                    <option value="4">E</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneGroupCode">Group Code</label>
                  <select id="tk115ToneGroupCode">
                    <option value="0">A</option>
                    <option value="1">B</option>
                    <option value="2">C</option>
                    <option value="3">D</option>
                    <option value="4">E</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneAutoResetTime">Auto Reset Time (5-60s)</label>
                  <input type="number" id="tk115ToneAutoResetTime" min="5" max="60" value="10">
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneProtocol">Protocol</label>
                  <select id="tk115ToneProtocol">
                    <option value="0">EIA</option>
                    <option value="1">EEA</option>
                    <option value="2">CCIR</option>
                    <option value="3">ZVEI1</option>
                    <option value="4">ZVEI2</option>
                    <option value="5">User</option>
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneUpCode">Up Code (14 chars)</label>
                  <input type="text" id="tk115ToneUpCode" maxlength="14" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneDownCode">Down Code (14 chars)</label>
                  <input type="text" id="tk115ToneDownCode" maxlength="14" placeholder="" pattern="[0-9]*">
                </div>
                
                <div class="field-group">
                  <label for="tk115TonePreLoadTime">Pre Load Time (ms)</label>
                  <select id="tk115TonePreLoadTime">
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneFirstCodePersist">First Code Persist (ms)</label>
                  <select id="tk115ToneFirstCodePersist">
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneCodeContinue">Code Continue Time (ms)</label>
                  <select id="tk115ToneCodeContinue">
                  </select>
                </div>
                
                <div class="field-group">
                  <label for="tk115ToneCodeInterval">Code Interval Time (ms)</label>
                  <select id="tk115ToneCodeInterval">
                  </select>
                </div>
              </div>
              
              <!-- 5TONE User Frequencies -->
              <h4 style="margin-top: 2rem; margin-bottom: 1rem;">User Frequencies (350-3500 Hz)</h4>
              <div class="tk11-settings-grid" id="tk115ToneUserFreqs">
                <!-- Generated by JavaScript -->
              </div>
              
              <!-- 5TONE Contacts Table -->
              <h4 style="margin-top: 2rem; margin-bottom: 1rem;">5TONE Contacts</h4>
              <button id="tk115ToneClearBtn" class="ghost" style="margin-bottom: 1rem;">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  </svg>
                </span>
                Clear All Contacts
              </button>
              
              <table class="dtmf-table">
                <thead>
                  <tr>
                    <th class="index-col">#</th>
                    <th>Name (8 chars)</th>
                    <th>Code ID (3 chars)</th>
                    <th style="width: 60px;"></th>
                  </tr>
                </thead>
                <tbody id="tk115ToneTableBody">
                  <!-- 16 5TONE contacts will be generated by JavaScript -->
                </tbody>
              </table>
            </div>
            

            <!-- Tab 9: Radio FM -->
            <div class="tab-content" id="tab-tk11-fm">
              <h3>Radio FM Frequencies</h3>
              <p class="muted">Quick frequency memory slots (EEPROM: 0x12000). Range: 76-108 MHz.</p>
              
              <div class="radio-actions">
                <button id="tk11FMReadBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="7 10 12 15 17 10"></polyline>
                      <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                  </span>
                  Read FM
                </button>
                <button id="tk11FMWriteBtn">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </span>
                  Write FM
                </button>
                <button id="tk11FMClearBtn" class="ghost">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <polyline points="3 6 5 6 21 6"></polyline>
                      <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                  </span>
                  Clear All
                </button>
              </div>
              
              <div class="field-group" style="max-width: 200px; margin-bottom: 1rem;">
                <label for="tk11FMChannel">Current Channel (1-32)</label>
                <input type="number" id="tk11FMChannel" min="1" max="32" value="1">
              </div>
              
              <div class="field-group" style="max-width: 200px; margin-bottom: 1rem;">
                <label for="tk11FMMode">FM Mode</label>
                <select id="tk11FMMode">
                  <option value="0">VFO</option>
                  <option value="1">Memory</option>
                </select>
              </div>
              
              <div class="field-group" style="max-width: 200px; margin-bottom: 1rem;">
                <label for="tk11FMVFO">Current VFO (MHz)</label>
                <input type="number" id="tk11FMVFO" min="76" max="108" step="0.1" value="87.5">
              </div>
              
              <table class="dtmf-table">
                <thead>
                  <tr>
                    <th class="index-col">#</th>
                    <th>Frequency (MHz)</th>
                    <th style="width: 60px;"></th>
                  </tr>
                </thead>
                <tbody id="tk11FMTableBody">
                  <!-- 32 FM frequencies will be generated by JavaScript -->
                </tbody>
              </table>
            </div>

            <!-- Tab: Logo Editor -->
            <div class="tab-content" id="tab-tk11-logo">
              <h3>Logo Editor</h3>
              <p class="muted">Edit and upload custom 128√ó64 monochrome logo (Memory: 0x0D6008-0x0D6408).</p>
              
              <div class="logo-editor-container" style="margin: 1.5rem 0;">
                <!-- Canvas Preview -->
                <div class="logo-preview" style="background: #B8D4A8; padding: 1rem; border-radius: 8px; display: inline-block; margin-bottom: 1rem;">
                  <canvas id="logoCanvas" width="128" height="64" style="border: 2px solid #333; display: block; image-rendering: pixelated; image-rendering: crisp-edges;"></canvas>
                </div>
                
                <!-- Bot√µes de Controle -->
                <div class="logo-controls" style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 1rem;">
                  <button id="logoLoadImageBtn" class="primary">
                    <span class="btn-icon">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                      </svg>
                    </span>
                    Load Image / .BAK
                  </button>
                  
                  <button id="logoReadBtn" class="primary">
                    <span class="btn-icon">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                      </svg>
                    </span>
                    Read from Radio
                  </button>
                  
                  <button id="logoWriteBtn">
                    <span class="btn-icon">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                      </svg>
                    </span>
                    Write to Radio
                  </button>
                  
                  <button id="logoClearBtn" class="ghost">
                    <span class="btn-icon">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                      </svg>
                    </span>
                    Clear
                  </button>
                  
                  <button id="logoInvertBtn" class="ghost">
                    <span class="btn-icon">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 2 A10 10 0 0 1 12 22 Z"></path>
                      </svg>
                    </span>
                    Invert
                  </button>
                  
                  <button id="logoSaveBAKBtn">
                    <span class="btn-icon">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                      </svg>
                    </span>
                    Save .BAK
                  </button>
                </div>
                
                <!-- File input (hidden) -->
                <input type="file" id="logoFileInput" accept=".bak,.png,.jpg,.jpeg,.bmp" style="display: none;">
              </div>
            </div>

            
          </div>
        </section>
      </section>


      <!-- Display Mirror Page -->
      <section class="page" id="mirror" data-page>
        <header class="hero">
          <div>
            <p class="eyebrow">MIRROR TOOL</p>
            <h1>Display mirror</h1>
            <p class="subtitle">Mirror the radio display in real time.</p>
            <div class="profile-selector">
              <label for="mirrorProfileSelect">Profile:</label>
              <select id="mirrorProfileSelect">
                <option value="joaquim" selected>Joaquim UV-KX</option>
                <option value="f4hwn">F4HWN UV-K5v1/v3 UV-K1</option>
                <option value="test">Test Pattern</option>
              </select>
            </div>
            
          </div>

          <section class="status-card mirror-status">
            <div class="mirror-status-main">
              <div class="status-top">
                <span class="status-dot" id="mirrorStatusDot" data-status="disconnected"></span>
                <div>
                  <div id="mirrorStatusTitle">Disconnected</div>
                  <p class="muted" id="mirrorStatusSubtitle">No radio connected.</p>
                </div>
              </div>
              <div class="mirror-actions">
                <div class="status-actions">
                  <button class="ghost" id="mirrorToggle" disabled>
                    <span class="btn-icon" aria-hidden="true">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <path d="M5 5l14 7-14 7z" />
                      </svg>
                    </span>
                    <span class="btn-label">Start mirror</span>
                  </button>
                  <button class="ghost" id="mirrorSave" disabled>
                    <span class="btn-icon" aria-hidden="true">
                      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                        <path d="M12 3v12" />
                        <path d="M7 10l5 5 5-5" />
                        <path d="M4 20h16" />
                      </svg>
                    </span>
                    <span class="btn-label">Save screenshot</span>
                  </button>
                </div>
              </div>
            </div>
            <div class="mirror-status-side">
              <div class="mirror-meta">
                <div>
                  <div class="muted">Firmware</div>
                  <div id="mirrorFirmware">-</div>
                </div>
              </div>
              <div class="status-error" id="mirrorError" hidden></div>
            </div>
          </section>
        </header>
        <section class="panel mirror-host">
          <label class="mirror-select">
            <span class="muted">Screen color</span>
            <select id="mirrorColor" disabled>
              <option value="amber">Amber</option>
              <option value="white">White</option>
            </select>
          </label>
          <div class="lcd-shell lcd-amber" id="lcdShell">
            <canvas id="lcdCanvas" width="512" height="256"></canvas>
          </div>
        </section>
      </section>

      <!-- SMR Page -->
      <section class="page" id="smr" data-page>
        <header class="hero">
          <div>
            <p class="eyebrow">SMR TOOL</p>
            <h1>SMR</h1>
            <p class="subtitle">Short message radio for sending and receiving SMS frames.</p>
            <div class="profile-selector">
              <label for="smrProfileSelect">Profile:</label>
              <select id="smrProfileSelect">
                <option value="joaquim-uv-kx" selected>Joaquim UV-KX / MCFW V0.33.0C &amp; V0.34.0C</option>
              </select>
            </div>
            <p class="subtitle">Select the message app in the radio (F+M) to use this tool.</p>
            
          </div>
          <section class="status-card status-split smr-status">
            <div class="status-main">
              <div class="status-top">
                <span class="status-dot" id="smrStatusDot" data-status="disconnected"></span>
                <div>
                  <div id="smrStatusTitle">Disconnected</div>
                  <p class="muted" id="smrStatusSubtitle">No radio connected.</p>
                </div>
              </div>
            </div>
            <div class="status-side">
              <div class="status-meta">
                <div>
                  <div class="muted">Firmware</div>
                  <div id="smrFirmware">-</div>
                </div>
              </div>
              <div class="status-error" id="smrError" hidden></div>
            </div>
          </section>
        </header>

        <section class="panel sms-panel">
          <div class="log-header">
            <h2>Messages</h2>
            <button id="smsClear" class="ghost small">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M3 6h18" />
                  <path d="M8 6V4h8v2" />
                  <path d="M6 6l1 14h10l1-14" />
                </svg>
              </span>
              Clear
            </button>
          </div>
          <div id="smsLog" class="log-output sms-log" aria-live="polite"></div>
          <div class="sms-compose">
            <input id="smsInput" type="text" maxlength="30" placeholder="Type a message" disabled />
            <button id="smsSend" class="primary" disabled>
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M4 12h16" />
                  <path d="M14 5l7 7-7 7" />
                </svg>
              </span>
              Send
            </button>
          </div>
          <p class="hint">Use Enter to send.</p>
        </section>
      </section>

      <!-- Unbricking Page - K5 Only -->
      <section class="page k5-only" id="unbricking" data-page>
        <header class="hero">
          <div>
            <p class="eyebrow">RECOVERY TOOL</p>
            <h1>üîß Unbricking UV-K5 V1</h1>
            <p class="subtitle">Restore a bricked UV-K5 V1 using ST-LINK V2 and OpenOCD</p>
          </div>
        </header>

        <!-- Hero Image -->
        <div style="text-align: center; margin: 20px 0;">
          <img src="unbrick/pcbite.jpg" alt="UV-K5 V1 Unbricking Setup" style="max-width: 100%; max-height: 400px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
        </div>

        <p class="hint" style="margin-bottom: 16px; background: #fff3cd; padding: 12px; border-radius: 8px; border-left: 4px solid #ffc107;">
          ‚ö†Ô∏è <strong>F4HWN 4.3 Fusion üî• Edition is ONLY compatible with UV-K5 V3 and UV-K1.</strong> 
          When flashed onto a UV-K5 V1, it causes a complete brick. Fortunately, the UV-K5 V1 can be fully restored using OpenOCD and a ST-LINK programmer.
        </p>

        <section class="panel-grid">
          <section class="panel">
            <h2>‚ùå When do you need this?</h2>
            <p class="muted">Your UV-K5 V1 may be bricked if:</p>
            <ul style="margin: 12px 0; padding-left: 20px; color: #c0392b;">
              <li>‚ùå The radio does not power on anymore</li>
              <li>‚ùå DFU mode is unavailable (PTT + Power ON doesn't work)</li>
              <li>‚ùå No LED activity at all</li>
              <li>‚ùå Flashing tools cannot detect the device</li>
            </ul>
            <p class="muted" style="margin-top: 12px;">This usually happens when you flash a UV-K5 V1 with firmware meant for UV-K1 or UV-K5 V3 (like F4HWN Fusion üî• Edition).</p>
          </section>

          <section class="panel">
            <h2>üìã Requirements</h2>
            <ul style="margin: 12px 0; padding-left: 20px; color: #666;">
              <li>üîå <strong>ST-LINK V2</strong> programmer (original or clone)</li>
              <li>üîó <strong>4 Dupont jumper wires</strong></li>
              <li>üîß <strong>Small screwdriver</strong> to open the radio</li>
              <li>üíª <strong>OpenOCD</strong> installed on your computer (Windows / macOS / Linux)</li>
            </ul>
          </section>
        </section>

        <!-- Installing OpenOCD -->
        <section class="panel-grid" style="margin-top: 24px;">
          <section class="panel" style="grid-column: span 2;">
            <h2>üì• Installing OpenOCD</h2>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 12px;">
              <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; text-align: center;">
                <strong style="color: #333;">üçé macOS (Homebrew)</strong>
                <div style="background: #1e1e1e; padding: 8px; border-radius: 4px; font-family: monospace; font-size: 12px; margin-top: 8px; color: #d4d4d4;">brew install openocd</div>
              </div>
              <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; text-align: center;">
                <strong style="color: #333;">ü™ü Windows</strong>
                <div style="margin-top: 8px; font-size: 13px;">
                  <a href="https://openocd.org/pages/getting-openocd.html" target="_blank">Official Website</a> or 
                  <a href="https://github.com/openocd-org/openocd/releases" target="_blank">GitHub Releases</a>
                </div>
              </div>
              <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; text-align: center;">
                <strong style="color: #333;">üêß Linux (Ubuntu/Debian)</strong>
                <div style="background: #1e1e1e; padding: 8px; border-radius: 4px; font-family: monospace; font-size: 12px; margin-top: 8px; color: #d4d4d4;">sudo apt install openocd</div>
              </div>
            </div>
            <p style="margin-top: 12px; font-size: 13px;">Verify installation: <code style="background: #1e1e1e; padding: 4px 8px; border-radius: 4px; color: #d4d4d4;">openocd --version</code></p>
            <div style="text-align: center; margin-top: 16px;">
              <img src="unbrick/openocd.png" alt="OpenOCD Output" style="max-width: 100%; max-height: 200px; border-radius: 8px; border: 1px solid #ddd;">
              <p style="font-size: 12px; color: #888; margin-top: 4px;">OpenOCD successful output</p>
            </div>
          </section>
        </section>

        <!-- SWD Connection -->
        <section class="panel-grid" style="margin-top: 24px;">
          <section class="panel">
            <h2>üîå SWD Connection Points</h2>
            <p class="muted">The radio must be opened to access the front side of the PCB. Connect the ST-LINK V2 to these pins:</p>
            <table style="width: 100%; margin: 12px 0; border-collapse: collapse; font-size: 14px;">
              <thead>
                <tr style="background: #f5f5f5;">
                  <th style="padding: 10px; border: 1px solid #ddd; text-align: center;">Signal</th>
                  <th style="padding: 10px; border: 1px solid #ddd; text-align: center;">UV-K5 V1 Pad</th>
                  <th style="padding: 10px; border: 1px solid #ddd; text-align: center;">ST-LINK Pin</th>
                </tr>
              </thead>
              <tbody>
                <tr><td style="padding: 8px; border: 1px solid #ddd; text-align: center;"><strong>GND</strong></td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">GND pad</td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">GND</td></tr>
                <tr><td style="padding: 8px; border: 1px solid #ddd; text-align: center;"><strong>SWCLK</strong></td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">SWCLK pad</td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">SWCLK</td></tr>
                <tr><td style="padding: 8px; border: 1px solid #ddd; text-align: center;"><strong>SWDIO</strong></td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">SWDIO pad</td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">SWDIO</td></tr>
                <tr><td style="padding: 8px; border: 1px solid #ddd; text-align: center;"><strong>3.3V</strong></td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">VCC pad</td><td style="padding: 8px; border: 1px solid #ddd; text-align: center;">3.3V</td></tr>
              </tbody>
            </table>
            <div style="background: #ffebee; padding: 12px; border-radius: 8px; margin-top: 12px; border-left: 4px solid #f44336; color: #b71c1c;">
              <strong>‚ö†Ô∏è WARNING:</strong> Do NOT connect the battery while using the ST-LINK. The ST-LINK provides 3.3V to the board.
            </div>
          </section>

          <section class="panel">
            <h2>üìç PCB Connection Images</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div style="text-align: center;">
                <img src="unbrick/pinout.jpg" alt="SWD Pinout Location" style="max-width: 100%; border-radius: 8px; border: 1px solid #ddd;">
                <p style="font-size: 12px; color: #888; margin-top: 4px;">SWD Pinout Location</p>
              </div>
              <div style="text-align: center;">
                <img src="unbrick/bottom.png" alt="PCB Bottom View" style="max-width: 100%; border-radius: 8px; border: 1px solid #ddd;">
                <p style="font-size: 12px; color: #888; margin-top: 4px;">PCB Connection Points</p>
              </div>
            </div>
          </section>
        </section>

        <!-- Download Toolkit -->
        <section class="panel-grid" style="margin-top: 24px;">
          <section class="panel" style="grid-column: span 2;">
            <h2>üì¶ Download Unbrick Toolkit</h2>
            <p class="muted">Download the complete toolkit containing bootloader, OpenOCD configs, and helper script:</p>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin: 16px 0;">
              <a href="https://github.com/user-attachments/files/24083102/unbrick_k5_v1.zip" target="_blank" style="text-decoration: none; display: block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                <div style="font-size: 24px; margin-bottom: 8px;">üì•</div>
                <strong>Complete Toolkit (ZIP)</strong>
                <div style="font-size: 12px; opacity: 0.9; margin-top: 4px;">13.5MB - Includes bootloader, configs & video</div>
              </a>
              
              <a href="https://1drv.ms/f/c/5d40488ea2119b08/IgAshx87imRRRLuy6jx0-xCzAY25Zj3vSB3H5TlePGPj5Uw?e=orBJJ6" target="_blank" style="text-decoration: none; display: block; background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%); color: white; padding: 16px; border-radius: 8px; text-align: center;">
                <div style="font-size: 24px; margin-bottom: 8px;">ü™ü</div>
                <strong>Windows Version</strong>
                <div style="font-size: 12px; opacity: 0.9; margin-top: 4px;">by @dguimaraes88 - Easier for Windows users</div>
              </a>
            </div>
            
            <p style="margin-top: 12px; font-size: 13px;">Or download individual files:</p>
            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
              <a href="unbrick/bootloader.bin" download style="background: #e9ecef; padding: 8px 16px; border-radius: 4px; text-decoration: none; color: #333; font-size: 13px;">üíæ bootloader.bin (4KB)</a>
              <a href="unbrick/unbrick_k5_v1.sh" download style="background: #e9ecef; padding: 8px 16px; border-radius: 4px; text-decoration: none; color: #333; font-size: 13px;">üìú unbrick_k5_v1.sh</a>
            </div>
          </section>
        </section>

        <!-- Unbrick Procedure -->
        <section class="panel-grid" style="margin-top: 24px;">
          <section class="panel" style="grid-column: span 2;">
            <h2>‚ö° Unbrick Procedure</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
              <div>
                <h3 style="color: #2196f3; font-size: 16px;">Step 1: Connect the ST-LINK</h3>
                <ol style="margin: 12px 0; padding-left: 20px; color: #666; line-height: 1.8;">
                  <li>Connect the ST-LINK pins to the SWD pads:
                    <ul style="margin-left: 16px; color: #27ae60;">
                      <li>3.3V ‚Üí 3.3V</li>
                      <li>SWDIO ‚Üí SWDIO</li>
                      <li>SWCLK ‚Üí SWCLK</li>
                      <li>GND ‚Üí GND</li>
                    </ul>
                  </li>
                  <li>Plug the ST-LINK into your computer</li>
                  <li>Power on your UV-K5 V1 (normal mode, without battery)</li>
                </ol>
              </div>
              
              <div>
                <h3 style="color: #2196f3; font-size: 16px;">Step 2: Flash the Bootloader</h3>
                <p style="font-size: 13px; color: #666;">From the <code>unbrick_k5_v1</code> directory:</p>
                
                <div style="background: #e8f5e9; padding: 12px; border-radius: 8px; margin: 8px 0; border-left: 4px solid #4caf50;">
                  <strong style="color: #2e7d32;">‚ú® Option A ‚Äî Helper script (Recommended)</strong>
                  <div style="background: #1e1e1e; padding: 8px; border-radius: 4px; font-family: monospace; font-size: 12px; margin-top: 8px; color: #d4d4d4;">./unbrick_k5_v1.sh</div>
                </div>
                
                <div style="background: #fff3e0; padding: 12px; border-radius: 8px; margin: 8px 0; border-left: 4px solid #ff9800;">
                  <strong style="color: #e65100;">üîß Option B ‚Äî Manual OpenOCD command</strong>
                  <div style="background: #1e1e1e; padding: 8px; border-radius: 4px; font-family: monospace; font-size: 11px; margin-top: 8px; color: #d4d4d4; overflow-x: auto; white-space: nowrap;">openocd -f ./interface/stlink.cfg -f ./target/dp32g030.cfg -c "init; reset halt; uv_flash_bl bootloader.bin; shutdown"</div>
                </div>
              </div>
            </div>
            
            <div style="background: #e3f2fd; padding: 12px; border-radius: 8px; margin-top: 16px; border-left: 4px solid #2196f3; color: #1565c0;">
              <strong>üí° Note for Windows users:</strong> You must either run this command with administrator privileges or launch OpenOCD.exe as an Administrator.
            </div>
            
            <h3 style="color: #27ae60; font-size: 16px; margin-top: 20px;">‚úÖ Step 3: After Successful Flash</h3>
            <p style="color: #666;">If no errors appear, the bootloader has been successfully restored:</p>
            <ol style="margin: 12px 0; padding-left: 20px; color: #666; line-height: 1.8;">
              <li>Disconnect and remove the ST-LINK from your UV-K5 V1 SWD port</li>
              <li>Reinstall the battery</li>
              <li>Power on the radio in <strong>DFU mode</strong> (hold PTT + Power ON)</li>
            </ol>
            <p style="color: #27ae60; margin-top: 12px;">
              ‚úÖ The device should now start correctly in DFU mode again. You can then flash stock firmware, or the 
              <a href="https://github.com/armel/uv-k5-firmware-custom" target="_blank" style="color: #2196f3;">F4HWN firmware for UV-K5 V1</a> 
              (not the Fusion üî• Edition).
            </p>
          </section>
        </section>

        <!-- Video Demo -->
        <section class="panel-grid" style="margin-top: 24px;">
          <section class="panel" style="grid-column: span 2;">
            <h2>üé¨ Video Demonstration</h2>
            <p class="muted">Watch the complete unbrick process in action. The video is included in the toolkit download.</p>
            <div style="text-align: center; margin: 16px 0; background: #f8f9fa; padding: 24px; border-radius: 8px;">
              <div style="font-size: 48px; margin-bottom: 12px;">üé¨</div>
              <p style="color: #666;">Video demo <strong>unbrick.mov</strong> is included in the Complete Toolkit ZIP</p>
              <a href="https://github.com/user-attachments/files/24083102/unbrick_k5_v1.zip" target="_blank" style="display: inline-block; margin-top: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none;">
                üì• Download Toolkit with Video
              </a>
            </div>
          </section>
        </section>

        <!-- YouTube Tutorials -->
        <section class="panel-grid" style="margin-top: 24px;">
          <section class="panel">
            <h2>üì∫ Video Tutorials</h2>
            <p class="muted">If you're new to ST-LINK, OpenOCD, or SWD debugging, these videos will give you a clear visual overview:</p>
            <div style="margin-top: 12px;">
              <a href="https://www.youtube.com/watch?v=4cWtYH_bpro" target="_blank" style="display: block; background: #ff0000; color: white; padding: 12px 16px; border-radius: 8px; text-decoration: none; margin-bottom: 8px;">
                <strong>üé¨ Your UV-K5 V1 is bricked? ü´£ Here's how to fix it üòå</strong>
                <div style="font-size: 12px; opacity: 0.9; margin-top: 4px;">by F4HWN</div>
              </a>
              <a href="https://www.youtube.com/watch?v=EmF08o5MIE0" target="_blank" style="display: block; background: #ff0000; color: white; padding: 12px 16px; border-radius: 8px; text-decoration: none;">
                <strong>üé¨ UNBRICK - Process Windows Quansheng UV-K5, K6</strong>
                <div style="font-size: 12px; opacity: 0.9; margin-top: 4px;">by M0FXB</div>
              </a>
            </div>
            <p style="margin-top: 12px; font-size: 12px; color: #888;">‚ÑπÔ∏è These resources are not mandatory, but they can make the procedure much easier to follow.</p>
          </section>

          <section class="panel">
            <h2>‚ö†Ô∏è Important Notes</h2>
            <ul style="margin: 12px 0; padding-left: 20px; color: #666; line-height: 1.8;">
              <li>This procedure is for <strong>UV-K5 V1 only</strong></li>
              <li>UV-K5 V3 and UV-K1 use different firmware and don't need this</li>
              <li>Opening the radio may void warranty</li>
              <li>Work carefully with the PCB connections</li>
              <li>Double-check all wiring before powering on</li>
              <li>Never connect battery while ST-LINK is connected</li>
            </ul>
            
            <div style="background: linear-gradient(135deg, #ff5722 0%, #e64a19 100%); color: white; padding: 16px; border-radius: 8px; margin-top: 16px;">
              <strong>‚ö†Ô∏è DISCLAIMER</strong>
              <p style="margin-top: 8px; font-size: 13px;">This procedure requires opening the device and directly manipulating its microcontroller over SWD. <strong>Incorrect use may permanently damage the radio.</strong> Proceed at your own risk.</p>
            </div>
          </section>
        </section>

        <!-- Credits -->
        <div style="text-align: center; margin-top: 24px; padding: 16px; background: #f8f9fa; border-radius: 8px;">
          <p style="color: #666; margin: 0;">
            ‚ù§Ô∏è Guide and tools by <a href="https://github.com/armel" target="_blank" style="color: #2196f3;">F4HWN (Armel)</a>
            &nbsp;‚Ä¢&nbsp;
            Windows version by <a href="https://github.com/dguimaraes88" target="_blank" style="color: #2196f3;">@dguimaraes88</a>
          </p>
        </div>
      </section>


            <!-- UV-K5/K1 Flash Tools Section -->
      <section class="page" id="k1" data-page>
        <header class="hero">
          <div>
            <p class="eyebrow">FLASH TOOLS</p>
            <h1 class="k5-only">UV-K5/K1 Flash Tools</h1>
            <h1 class="rt890-only" style="display: none;">RT-890 Flash Tools</h1>
            <p class="subtitle k5-only">Flash firmware for UV-K5 and UV-K1 radios.</p>
            <p class="subtitle rt890-only" style="display: none;">Flash firmware for RT-890 radios.</p>
          </div>
        </header>

        <!-- K5 Flash Section - Only visible when K5 is selected -->
        <div class="k5-only">
        <h2 class="section-title">UV-K5/K6/5R firmware Firmware</h2>
        <p class="hint" style="margin-bottom: 16px;">‚ö†Ô∏è Connect the radio in boot mode ( PTT + Power ON ) from the navigation bar before flashing.</p>
        <section class="panel-grid">
          <section class="panel">
            <h2>Flash Firmware (UV-K5/K6/5R)</h2>
            <p class="muted">Select a pre-loaded firmware or upload your own.</p>
            
            <div class="field-row">
              <label for="k5FirmwareSelect">Pre-loaded Firmwares</label>
              <select id="k5FirmwareSelect">
                <option value="">Select Firmware</option>
              </select>
            </div>
            
            <div class="field-row">
              <label for="firmwareFile">Or upload custom firmware</label>
              <input type="file" id="firmwareFile" accept=".bin,.hex" />
            </div>
            
            <div class="field-row">
              <label for="k5FirmwareUrl">Or paste firmware URL</label>
              <div style="display: flex; gap: 8px;">
                <input type="url" id="k5FirmwareUrl" placeholder="https://example.com/firmware.bin" style="flex: 1;" />
                <button id="k5LoadUrlBtn" class="secondary" type="button">Load</button>
              </div>
            </div>
            
            <p class="hint" id="k5FirmwareStatus">No firmware selected</p>
            
            <button id="flashBtn" class="primary">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M13 2L3 14h6l-2 8 10-12h-6l2-8z" />
                </svg>
              </span>
              Flash UV-K5/K6/5R
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="flashPct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="flashFill"></div>
              </div>
            </div>
          </section>
        </section>

        </div>

        <!-- K1 Flash Section - Only visible when K5 is selected -->
        <div class="k5-only">
        <h2 class="section-title">UV-K5 V3 & UV-K1 Firmware</h2>
        <p class="hint" style="margin-bottom: 16px;">‚ö†Ô∏è Connect the radio in boot mode ( PTT + Power ON ) from the navigation bar before flashing.</p>
        <section class="panel-grid">
          <section class="panel">
            <h2>Flash Firmware (UV-K5 V3 & UV-K1)</h2>
            <p class="muted">Select a pre-loaded firmware or upload your own.</p>
            
            <div class="field-row">
              <label for="k1FirmwareSelect">Pre-loaded Firmwares</label>
              <select id="k1FirmwareSelect">
                <option value="">-- Select firmware --</option>
                <optgroup label="F4HWN Firmware">
                  <option value="firmware/f4hwn.k5v3.fusion.v4.3.2.bin">F4HWN Fusion v4.3.2 (K5v3)</option>
                  <option value="firmware/f4hwn.k1.fusion.v4.3.2.bin">F4HWN Fusion v4.3.2 (K1)</option>
                </optgroup>
                <optgroup label="Calypso Firmware">
                  <option value="firmware/f4hwn.calypso_v1.2.bin">Calypso Edition v1.2</option>
                </optgroup>
                <optgroup label="Quansheng Stock Firware">
                  <option value="firmware/quansheng.k5v3.stock.firmware.v7.00.11.bin">Quansheng Stock v7.00.11 (K5v3)</option>
                  <option value="firmware/quansheng.k1.stock.firmware.v7.02.02.bin">Quansheng Stock v7.02.02 (K1)</option>
                </optgroup>
              </select>
            </div>
            
            <div class="field-row">
              <label for="k1FirmwareFile">Or upload custom firmware</label>
              <input type="file" id="k1FirmwareFile" accept=".bin" />
            </div>
            
            <div class="field-row">
              <label for="k1FirmwareUrl">Or paste firmware URL</label>
              <div style="display: flex; gap: 8px;">
                <input type="url" id="k1FirmwareUrl" placeholder="https://example.com/firmware.bin" style="flex: 1;" />
                <button id="k1LoadUrlBtn" class="secondary" type="button">Load</button>
              </div>
            </div>
            
            <p class="hint" id="k1FirmwareStatus">No firmware selected</p>
            
            <button id="k1FlashBtn" class="primary">
              <span class="btn-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M13 2L3 14h6l-2 8 10-12h-6l2-8z" />
                </svg>
              </span>
              Flash UV-K5 V3 & UV-K1
            </button>
            <div class="progress">
              <div class="progress-label">
                <span>Progress</span>
                <span id="k1FlashPct">0%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="k1FlashFill"></div>
              </div>
            </div>
          </section>
        </section>

        </div>

        

        <!-- RT-890 Flash Section - Only visible when RT-890 is selected -->
        <div class="rt890-only" id="rt890FlashSection" style="display: none;">
          <h2 class="section-title">RT-890 Firmware</h2>
          <p class="hint" style="margin-bottom: 16px;">‚ö†Ô∏è Connect the radio in bootloader mode: Turn OFF, hold PTT, then turn ON.</p>
          <section class="panel-grid">
            <section class="panel">
              <h2>Flash Firmware (RT-890)</h2>
              <p class="muted">Select a pre-loaded firmware or upload your own .bin file.</p>
              
              <div class="field-row">
                <label for="rt890FirmwareSelect">Pre-loaded Firmwares</label>
                <select id="rt890FirmwareSelect">
                  <optgroup label="M7OCM Firmware (PCB 2.0)">
                    <option value="firmware/rt890-m7ocm-v2.2.5X-pcb2.0.bin">M7OCM v2.2.5X (PCB 2.0)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.4X-pcb2.0.bin">M7OCM v2.2.4X (PCB 2.0)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.4Q-pcb2.0.bin">M7OCM v2.2.4Q (PCB 2.0) - Spectrum Auto Light</option>
                    <option value="firmware/rt890-m7ocm-v2.2.3Q-pcb2.0.bin">M7OCM v2.2.3Q (PCB 2.0) - Spectrum Auto Light</option>
                    <option value="firmware/rt890-m7ocm-v2.2.3-pcb2.0.bin">M7OCM v2.2.3 (PCB 2.0)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.1-pcb2.0.bin">M7OCM v2.2.1 (PCB 2.0)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.0-pcb2.0.bin">M7OCM v2.2.0 (PCB 2.0)</option>
                    <option value="firmware/rt890-m7ocm-240filter-v2.2.2-pcb2.0.bin">M7OCM v2.2.2 240MHz Filter (PCB 2.0)</option>
                    <option value="firmware/rt890-m7ocm-280filter-v2.2.2-pcb2.0.bin">M7OCM v2.2.2 280MHz Filter (PCB 2.0)</option>
                  </optgroup>
                  <optgroup label="M7OCM Firmware (PCB 2.1)">
                    <option value="firmware/rt890-m7ocm-v2.2.5X-pcb2.1.bin">M7OCM v2.2.5X (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.4X-pcb2.1.bin">M7OCM v2.2.4X (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.4Q-pcb2.1.bin">M7OCM v2.2.4Q (PCB 2.1) - Spectrum Auto Light</option>
                    <option value="firmware/rt890-m7ocm-v2.2.3Q-pcb2.1.bin">M7OCM v2.2.3Q (PCB 2.1) - Spectrum Auto Light</option>
                    <option value="firmware/rt890-m7ocm-v2.2.3-pcb2.1.bin">M7OCM v2.2.3 (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.1-pcb2.1.bin">M7OCM v2.2.1 (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-v2.2.0-pcb2.1.bin">M7OCM v2.2.0 (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-v2.1.9-pcb2.1.bin">M7OCM v2.1.9 (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-v2.1.8-pcb2.1.bin">M7OCM v2.1.8 (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-v2.1.7-pcb2.1.bin">M7OCM v2.1.7 (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-240filter-v2.2.2-pcb2.1.bin">M7OCM v2.2.2 240MHz Filter (PCB 2.1)</option>
                    <option value="firmware/rt890-m7ocm-280filter-v2.2.2-pcb2.1.bin">M7OCM v2.2.2 280MHz Filter (PCB 2.1)</option>
                  </optgroup>
                  <optgroup label="OEFWCOM Base">
                    <option value="firmware/rt890-oefwcom-21102024.bin">OEFWCOM 21/10/2024</option>
                  </optgroup>
                </select>
              </div>
              
              <div class="field-row">
                <label for="rt890FirmwareFile">Or upload custom firmware</label>
                <input type="file" id="rt890FirmwareFile" accept=".bin" />
              </div>
              
              <div class="field-row">
                <label for="rt890FirmwareUrl">Or paste firmware URL</label>
                <div style="display: flex; gap: 8px;">
                  <input type="url" id="rt890FirmwareUrl" placeholder="https://example.com/firmware.bin" style="flex: 1;" />
                  <button id="rt890LoadUrlBtn" class="secondary" type="button">Load</button>
                </div>
              </div>
              
              <p class="hint" id="rt890FirmwareStatus">No firmware selected</p>
              
              <button id="rt890FlashBtn" class="primary">
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M13 2L3 14h6l-2 8 10-12h-6l2-8z" />
                  </svg>
                </span>
                Flash RT-890
              </button>
              <div class="progress">
                <div class="progress-label">
                  <span>Progress</span>
                  <span id="rt890FlashPct">0%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="rt890FlashFill"></div>
                </div>
              </div>
            </section>
            <!-- SPI Backup/Restore Panel -->
            <section class="panel">
              <h2>SPI Flash Backup / Restore (RT-890)</h2>
              <p class="muted">Backup or restore the 4MB SPI flash memory (calibration data, settings).</p>
              <p class="hint warning-box">‚ö†Ô∏è Radio must be in NORMAL MODE (not bootloader) for SPI operations!</p>
              
              <div class="field-row">
                <label for="spiBaudRate">Connection Speed</label>
                <select id="spiBaudRate">
                  <option value="115200" selected>Fast (115200 baud)</option>
                  <option value="19200">Slow (19200 baud) - More reliable</option>
                </select>
              </div>
              
              <div class="spi-buttons">
                <button id="spiBackupBtn" class="primary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                      <polyline points="7 10 12 15 17 10"/>
                      <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                  </span>
                  Backup SPI (4MB)
                </button>
                
                <button id="spiCancelBtn" class="secondary" disabled>
                  Cancel
                </button>
              </div>
              
              <hr style="margin: 16px 0; border-color: var(--color-border);">
              
              <div class="field-row">
                <label for="spiRestoreFile">Select backup file to restore</label>
                <input type="file" id="spiRestoreFile" accept=".bin" />
              </div>
              
              <button id="spiRestoreBtn" class="danger" disabled>
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                  </svg>
                </span>
                Restore SPI
              </button>
              
              <div class="progress" style="margin-top: 16px;">
                <div class="progress-label">
                  <span id="spiProgressText">Ready</span>
                  <span id="spiProgressPct">0%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="spiProgressBar" style="width: 0%"></div>
                </div>
              </div>
            </section>
            
            <!-- v7.5: Separate Calibration Panel -->
            <section class="panel">
              <h2>üìè RT-890 Calibration (4 KB)</h2>
              <p class="muted">Dump or restore ONLY the calibration region (0x3BF000 - 0x3BFFFF).</p>
              <p class="hint" style="background: var(--color-surface-alt); border-left: 3px solid var(--color-warning);">
                üí° <strong>Tip:</strong> Always backup calibration before flashing firmware!
                <br>Calibration contains TX power levels, frequency offsets, and radio-specific tuning.
              </p>
              
              <div class="field-row">
                <label for="spiCalibBaudRate">Connection Speed</label>
                <select id="spiCalibBaudRate">
                  <option value="115200" selected>Fast (115200 baud)</option>
                  <option value="19200">Slow (19200 baud) - More reliable</option>
                </select>
              </div>
              
              <div class="spi-buttons" style="margin-bottom: 16px;">
                <button id="spiDumpCalibBtn" class="secondary">
                  <span class="btn-icon" aria-hidden="true">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                      <polyline points="7 10 12 15 17 10"/>
                      <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                  </span>
                  Dump Calibration (4 KB)
                </button>
              </div>
              
              <div class="field-row">
                <label for="spiRestoreCalibFile">Select calibration file (must be exactly 4096 bytes)</label>
                <input type="file" id="spiRestoreCalibFile" accept=".bin" />
              </div>
              
              <button id="spiRestoreCalibBtn" class="danger" disabled>
                <span class="btn-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                  </svg>
                </span>
                Restore Calibration (4 KB)
              </button>
              
              <div class="progress" style="margin-top: 16px;">
                <div class="progress-label">
                  <span id="spiCalibProgressText">Ready</span>
                  <span id="spiCalibProgressPct">0%</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="spiCalibProgressBar" style="width: 0%"></div>
                </div>
              </div>
              
              <div id="spiCalibStatusLog" class="spi-status-log"></div>
            </section>

          </section>
          <div id="rt890Log" class="log-area"></div>
        </div>

        <!-- K5/K1 Log Area - Only visible when K5 is selected -->
        <div class="k5-only" id="k1Log" class="log-area"></div>
      </section>

      <nav class="sidebar">
        <div class="brand">
          <span class="brand-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
              <rect x="5" y="2" width="14" height="20" rx="2" />
              <path d="M9 22v-4h6v4" />
              <path d="M9 6h6" />
              <path d="M9 10h6" />
            </svg>
          </span>
          UV-K5
        </div>
        <ul class="nav">
          <li>
            <a href="#instructions" class="active" id="navInstructions">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="12" y1="16" x2="12" y2="12"></line>
                  <line x1="12" y1="8" x2="12.01" y2="8"></line>
                </svg>
              </span>
              Home
            </a>
          </li>
          <li>
            <a href="#home" id="navHome">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
                </svg>
              </span>
              Tools
            </a>
          </li>
          <li>
            <a href="#channels" id="navChannels">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M4 6h16" />
                  <path d="M4 12h16" />
                  <path d="M4 18h16" />
                </svg>
              </span>
              Channels
            </a>
          </li>
          <li>
            <a href="#settings" id="navSettings" class="k5-only">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <circle cx="12" cy="12" r="3" />
                  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
                </svg>
              </span>
              Settings
            </a></li>
          <li>
            <a href="#tk11-settings" id="navTK11Settings" class="tk11-only" style="display: none;">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <circle cx="12" cy="12" r="3" />
                  <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z" />
                </svg>
              </span>
              Settings
            </a>
          </li>
          <li>
            <a href="#mirror" id="navMirror">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <rect x="2" y="3" width="20" height="14" rx="2" />
                  <path d="M8 21h8" />
                  <path d="M12 17v4" />
                </svg>
              </span>
              Mirror
            </a>
          </li>
          <li>
            <a href="#smr" id="navSmr">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <path d="M4 4h16v16H4z" />
                  <path d="M8 8h8" />
                  <path d="M8 12h5" />
                </svg>
              </span>
              SMR
            </a>
          </li>
          <li>
            <a href="#k1" id="navK1">
              <span class="nav-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                  <rect x="5" y="2" width="14" height="20" rx="2" />
                  <path d="M12 18h.01" />
                </svg>
              </span>
              UV-K1
            </a>
          </li>
        </ul>
        <div class="sidebar-footer">
          <small id="footerCopyright"></small>
          <small>
            Tools intended for use with firmware:
            <a href="https://github.com/joaquimorg/UV-KX-firmware" target="_blank" rel="noopener">github.com/joaquimorg/UV-KX-firmware</a>
          </small>
        </div>
      </nav>
    </main>

    <!-- Channel Progress Modal -->
    <div id="channelModal" class="modal-overlay" aria-hidden="true">
      <div class="modal-card">
        <h2 id="modalTitle">Working...</h2>
        <p id="modalMessage" class="muted">Communicating with the radio.</p>
        <div class="progress active">
          <div class="progress-label">
            <span>Progress</span>
            <span id="modalPct">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="modalFill"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings Progress Modal -->
    <div id="settingsModal" class="modal-overlay" aria-hidden="true">
      <div class="modal-card">
        <h2 id="settingsModalTitle">Working...</h2>
        <p id="settingsModalMessage" class="muted">Communicating with the radio.</p>
        <div class="progress active">
          <div class="progress-label">
            <span>Progress</span>
            <span id="settingsModalPct">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="settingsModalFill"></div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Theme Switcher
      (function() {
        const themeSelect = document.getElementById('themeSelect');
        const savedTheme = localStorage.getItem('k5-editor-theme') || 'dark';
        
        // Apply saved theme on load
        document.documentElement.setAttribute('data-theme', savedTheme);
        themeSelect.value = savedTheme;
        
        // Handle theme change
        themeSelect.addEventListener('change', function() {
          const theme = this.value;
          document.documentElement.setAttribute('data-theme', theme);
          localStorage.setItem('k5-editor-theme', theme);
        });
      })();
    </script>
    <script src="js/spa.js" type="module"></script>
    <script src="js/protocol.js" type="module"></script>
    <script src="js/protocol-tk11.js" type="module"></script>
    <script src="js/radio-selector.js" type="module"></script>
    <script src="js/radio-protocol.js" type="module"></script>
    <script src="js/serial-manager.js" type="module"></script>
    <script src="js/profile-manager.js" type="module"></script>
    <script src="js/app.js" type="module"></script>
    <script src="js/channels.js" type="module"></script>
    <script src="js/basic-settings.js" type="module"></script>
    <script src="js/display-mirror.js" type="module"></script>
    <script src="js/smr.js" type="module"></script>
    <script src="js/display-mirror-joaquim.js" type="module"></script>
    <script src="js/display-mirror-test.js" type="module"></script>
  <script src="js/display-mirror-f4hwn.js" type="module"></script>
    <script src="js/smr-joaquim-uv-kx.js" type="module"></script>
    <script src="js/flash-k1.js" type="module"></script>
    <script src="js/flash-k1-ui.js" type="module"></script>
    <script src="js/flash-rt890.js" type="module"></script>
    <script src="js/flash-rt890-ui.js" type="module"></script>
    <script src="js/tk11-settings.js" type="module"></script>
    <script src="js/calibration.js" type="module"></script>
    <script src="js/spi-rt890.js"></script>
    <script src="js/spi-rt890-ui.js"></script>
    <script src="js/dtmf.js" type="module"></script>
    <script src="js/radio.js" type="module"></script>
    <script src="js/hexview.js" type="module"></script>
    <script type="module" src="js/logo-editor.js"></script>
    <script type="module" src="js/memory-size-detector.js"></script>
    <script type="module" src="js/lock-password.js"></script>
    <script src="js/cors-loader.js"></script>
    <script type="module" src="js/firmware-loader.js"></script>
    
    <!-- Tab switching logic -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Settings tabs functionality
        const tabBtns = document.querySelectorAll('.settings-tabs .tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        const settingsPanel = document.getElementById('settingsPanel');
        const settingsProgress = document.querySelector('.settings-tabs-container ~ .progress');
        
        tabBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            const targetTab = this.dataset.tab;
            
            // Remove active from all buttons and contents
            tabBtns.forEach(b => b.classList.remove('active'));
            tabContents.forEach(c => c.classList.remove('active'));
            
            // Add active to clicked button and corresponding content
            this.classList.add('active');
            const targetContent = document.getElementById('tab-' + targetTab);
            if (targetContent) {
              targetContent.classList.add('active');
            }
            
            // Show/hide settings panel based on active tab
            // Only show settingsPanel for firmware-profile tab
            if (settingsPanel) {
              if (targetTab === 'firmware-profile') {
                settingsPanel.style.display = '';
                if (settingsProgress) settingsProgress.style.display = '';
              } else {
                settingsPanel.style.display = 'none';
                if (settingsProgress) settingsProgress.style.display = 'none';
              }
            }
          });
        });
        
        console.log('Tab switching initialized');
      });
      
      // ============== CALIBRATION SECTION ==============
      // Calibration memory addresses (from f4hwn.chirp.v4.3.py)
      const CAL_START = 0x1E00;
      const CAL_END = 0x2000;  // Full calibration area (512 bytes)
      
      // Memory layout based on f4hwn.chirp.v4.3.py MEM_FORMAT
      const CAL_LAYOUT = {
        sqlBand4_7: {
          openRssiThr: { addr: 0x1E00, size: 10 },
          closeRssiThr: { addr: 0x1E10, size: 10 },
          openNoiseThr: { addr: 0x1E20, size: 10 },
          closeNoiseThr: { addr: 0x1E30, size: 10 },
          closeGlitchThr: { addr: 0x1E40, size: 10 },
          openGlitchThr: { addr: 0x1E50, size: 10 }
        },
        sqlBand1_3: {
          openRssiThr: { addr: 0x1E60, size: 10 },
          closeRssiThr: { addr: 0x1E70, size: 10 },
          openNoiseThr: { addr: 0x1E80, size: 10 },
          closeNoiseThr: { addr: 0x1E90, size: 10 },
          closeGlitchThr: { addr: 0x1EA0, size: 10 },
          openGlitchThr: { addr: 0x1EB0, size: 10 }
        },
        rssiLevelsBands3_7: { addr: 0x1EC0, size: 8 },
        rssiLevelsBands1_2: { addr: 0x1EC8, size: 8 },
        txp: { addr: 0x1ED0, size: 112 },
        batLvl: { addr: 0x1F40, size: 12 },
        vox1Thr: { addr: 0x1F50, size: 20 },
        vox0Thr: { addr: 0x1F68, size: 20 },
        micLevel: { addr: 0x1F80, size: 5 },
        xtalFreqLow: { addr: 0x1F88, size: 2 },
        volumeGain: { addr: 0x1F8E, size: 1 },
        dacGain: { addr: 0x1F8F, size: 1 }
      };
      
      // Calibration data storage - use window.calibData for sharing with module
      // Initialize if not already set by calibration.js
      if (!window.calibData) window.calibData = null;
      let currentSqlBand = 'sqlBand4_7';
      let currentTxBand = 0;
      
      // Getter/setter for calibData that uses window.calibData
      function getCalibData() { return window.calibData; }
      function setCalibData(data) { window.calibData = data; }
      
      // Make functions globally available for onclick handlers and calibration.js
      window.switchSqlBand = function(btn) {
        document.querySelectorAll('[data-band]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentSqlBand = btn.getAttribute('data-band');
        if (getCalibData()) {
          updateSqlTableFromData();
        }
      };
      
      window.switchTxBand = function(btn) {
        document.querySelectorAll('[data-txband]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentTxBand = parseInt(btn.getAttribute('data-txband'));
        if (getCalibData()) {
          updateTxPowerFromData();
        }
      };
      
      // Initialize calibration tables
      function initCalibrationTables() {
        // Generate Squelch table
        const squelchBody = document.getElementById('squelchTableBody');
        if (squelchBody) {
          squelchBody.innerHTML = '';
          for (let i = 0; i < 10; i++) {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td><strong>SQL ${i}</strong></td>
              <td><input type="number" id="sql_openRssi_${i}" min="0" max="255" value="0" class="calib-input"></td>
              <td><input type="number" id="sql_closeRssi_${i}" min="0" max="255" value="0" class="calib-input"></td>
              <td><input type="number" id="sql_openNoise_${i}" min="0" max="127" value="0" class="calib-input"></td>
              <td><input type="number" id="sql_closeNoise_${i}" min="0" max="127" value="0" class="calib-input"></td>
              <td><input type="number" id="sql_openGlitch_${i}" min="0" max="255" value="0" class="calib-input"></td>
              <td><input type="number" id="sql_closeGlitch_${i}" min="0" max="255" value="0" class="calib-input"></td>
            `;
            squelchBody.appendChild(row);
          }
        }
        
        // Generate VOX table
        const voxBody = document.getElementById('voxTableBody');
        if (voxBody) {
          voxBody.innerHTML = '';
          for (let i = 0; i < 10; i++) {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td><strong>Level ${i + 1}</strong></td>
              <td><input type="number" id="vox1Thr_${i}" min="0" max="65535" value="0" class="calib-input"></td>
              <td><input type="number" id="vox0Thr_${i}" min="0" max="65535" value="0" class="calib-input"></td>
            `;
            voxBody.appendChild(row);
          }
        }
      }
      
      // Load calibration from file
      function loadCalibrationFile(file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const data = new Uint8Array(e.target.result);
          let loadedData;
          
          // Check if it's a full EEPROM dump or just calibration data
          if (data.length >= 0x2000) {
            // Full EEPROM, extract calibration area
            loadedData = data.slice(CAL_START, CAL_END);
          } else if (data.length >= (CAL_END - CAL_START)) {
            // Calibration data only
            loadedData = data.slice(0, CAL_END - CAL_START);
          } else if (data.length === 512) {
            // Standard calibration file size
            loadedData = data;
          } else {
            alert('File too small to contain calibration data. Expected at least 512 bytes.');
            return;
          }
          
          // Store in global window.calibData for sharing with calibration.js module
          setCalibData(loadedData);
          
          updateAllCalibrationFields();
          document.getElementById('calibWriteBtn').disabled = false;
          document.getElementById('calibWriteFileBtn').disabled = false;
          document.getElementById('calibStatus').textContent = 'Loaded from file: ' + file.name;
          document.getElementById('calibProgress').style.display = 'block';
          document.getElementById('calibFill').style.width = '100%';
          document.getElementById('calibPct').textContent = '100%';
        };
        reader.readAsArrayBuffer(file);
      }
      
      // Write calibration to file (.bin)
      function writeCalibrationFile() {
        const calibData = getCalibData();
        if (!calibData) {
          alert('No calibration data to save!');
          return;
        }
        
        updateDataFromAllFields();
        
        const blob = new Blob([getCalibData()], {type: 'application/octet-stream'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'calibration_' + Date.now() + '.bin';
        a.click();
        URL.revokeObjectURL(url);
      }
      
      // Helper functions for data extraction
      function extractSqlBandData(band) {
        const calibData = getCalibData();
        const layout = CAL_LAYOUT[band];
        const result = { levels: [] };
        for (let i = 0; i < 10; i++) {
          result.levels.push({
            openRssi: calibData[layout.openRssiThr.addr - CAL_START + i],
            closeRssi: calibData[layout.closeRssiThr.addr - CAL_START + i],
            openNoise: calibData[layout.openNoiseThr.addr - CAL_START + i],
            closeNoise: calibData[layout.closeNoiseThr.addr - CAL_START + i],
            openGlitch: calibData[layout.openGlitchThr.addr - CAL_START + i],
            closeGlitch: calibData[layout.closeGlitchThr.addr - CAL_START + i]
          });
        }
        return result;
      }
      
      function extractRssiLevels(offset) {
        const calibData = getCalibData();
        return {
          level1: getUint16(calibData, offset),
          level2: getUint16(calibData, offset + 2),
          level4: getUint16(calibData, offset + 4),
          level6: getUint16(calibData, offset + 6)
        };
      }
      
      function extractTxPowerData() {
        const calibData = getCalibData();
        const bands = [];
        for (let b = 0; b < 7; b++) {
          const baseOffset = (0x1ED0 - CAL_START) + (b * 16);
          bands.push({
            low: { lower: calibData[baseOffset], center: calibData[baseOffset + 1], upper: calibData[baseOffset + 2] },
            mid: { lower: calibData[baseOffset + 3], center: calibData[baseOffset + 4], upper: calibData[baseOffset + 5] },
            hi: { lower: calibData[baseOffset + 6], center: calibData[baseOffset + 7], upper: calibData[baseOffset + 8] }
          });
        }
        return bands;
      }
      
      function extractBatteryData() {
        const calibData = getCalibData();
        const levels = [];
        for (let i = 0; i < 6; i++) {
          levels.push(getUint16(calibData, (0x1F40 - CAL_START) + (i * 2)));
        }
        return levels;
      }
      
      function extractVoxData() {
        const calibData = getCalibData();
        const vox = { on: [], off: [] };
        for (let i = 0; i < 10; i++) {
          vox.on.push(getUint16(calibData, (0x1F50 - CAL_START) + (i * 2)));
          vox.off.push(getUint16(calibData, (0x1F68 - CAL_START) + (i * 2)));
        }
        return vox;
      }
      
      function extractMicData() {
        const calibData = getCalibData();
        const levels = [];
        for (let i = 0; i < 5; i++) {
          levels.push(calibData[(0x1F80 - CAL_START) + i]);
        }
        return levels;
      }
      
      // Update UI from calibData
      // Make this function globally available for calibration.js
      window.updateAllCalibrationFields = function() {
        const calibData = getCalibData();
        if (!calibData) return;
        
        updateSqlTableFromData();
        updateRssiFromData();
        updateTxPowerFromData();
        updateBatteryFromData();
        updateVoxFromData();
        updateMicFromData();
        updateOtherFromData();
      }
      
      function updateSqlTableFromData() {
        const calibData = getCalibData();
        if (!calibData) return;
        const layout = CAL_LAYOUT[currentSqlBand];
        for (let i = 0; i < 10; i++) {
          setValue('sql_openRssi_' + i, calibData[layout.openRssiThr.addr - CAL_START + i]);
          setValue('sql_closeRssi_' + i, calibData[layout.closeRssiThr.addr - CAL_START + i]);
          setValue('sql_openNoise_' + i, calibData[layout.openNoiseThr.addr - CAL_START + i]);
          setValue('sql_closeNoise_' + i, calibData[layout.closeNoiseThr.addr - CAL_START + i]);
          setValue('sql_openGlitch_' + i, calibData[layout.openGlitchThr.addr - CAL_START + i]);
          setValue('sql_closeGlitch_' + i, calibData[layout.closeGlitchThr.addr - CAL_START + i]);
        }
      }
      
      function updateRssiFromData() {
        const calibData = getCalibData();
        if (!calibData) return;
        // Bands 3-7 (0x1EC0)
        setValue('rssi37_level1', getUint16(calibData, 0x1EC0 - CAL_START));
        setValue('rssi37_level2', getUint16(calibData, 0x1EC2 - CAL_START));
        setValue('rssi37_level4', getUint16(calibData, 0x1EC4 - CAL_START));
        setValue('rssi37_level6', getUint16(calibData, 0x1EC6 - CAL_START));
        
        // Bands 1-2 (0x1EC8)
        setValue('rssi12_level1', getUint16(calibData, 0x1EC8 - CAL_START));
        setValue('rssi12_level2', getUint16(calibData, 0x1ECA - CAL_START));
        setValue('rssi12_level4', getUint16(calibData, 0x1ECC - CAL_START));
        setValue('rssi12_level6', getUint16(calibData, 0x1ECE - CAL_START));
      }
      
      function updateTxPowerFromData() {
        const calibData = getCalibData();
        if (!calibData) return;
        const baseOffset = (0x1ED0 - CAL_START) + (currentTxBand * 16);
        setValue('txp_low_lower', calibData[baseOffset]);
        setValue('txp_low_center', calibData[baseOffset + 1]);
        setValue('txp_low_upper', calibData[baseOffset + 2]);
        setValue('txp_mid_lower', calibData[baseOffset + 3]);
        setValue('txp_mid_center', calibData[baseOffset + 4]);
        setValue('txp_mid_upper', calibData[baseOffset + 5]);
        setValue('txp_hi_lower', calibData[baseOffset + 6]);
        setValue('txp_hi_center', calibData[baseOffset + 7]);
        setValue('txp_hi_upper', calibData[baseOffset + 8]);
      }
      
      function updateBatteryFromData() {
        const calibData = getCalibData();
        if (!calibData) return;
        for (let i = 0; i < 6; i++) {
          setValue('batLvl_' + i, getUint16(calibData, (0x1F40 - CAL_START) + (i * 2)));
        }
      }
      
      function updateVoxFromData() {
        const calibData = getCalibData();
        if (!calibData) return;
        for (let i = 0; i < 10; i++) {
          setValue('vox1Thr_' + i, getUint16(calibData, (0x1F50 - CAL_START) + (i * 2)));
          setValue('vox0Thr_' + i, getUint16(calibData, (0x1F68 - CAL_START) + (i * 2)));
        }
      }
      
      function updateMicFromData() {
        const calibData = getCalibData();
        if (!calibData) return;
        for (let i = 0; i < 5; i++) {
          setValue('micLevel_' + i, calibData[(0x1F80 - CAL_START) + i]);
        }
      }
      
      function updateOtherFromData() {
        const calibData = getCalibData();
        if (!calibData) return;
        setValue('xtalFreqLow', getInt16(calibData, 0x1F88 - CAL_START));
        setValue('volumeGain', calibData[0x1F8E - CAL_START]);
        setValue('dacGain', calibData[0x1F8F - CAL_START]);
      }
      
      // Update calibData from UI fields
      // Make this function globally available for calibration.js
      window.updateDataFromAllFields = function() {
        const calibData = getCalibData();
        if (!calibData) return;
        
        updateSqlDataFromTable();
        updateRssiDataFromFields();
        updateTxPowerDataFromFields();
        updateBatteryDataFromFields();
        updateVoxDataFromFields();
        updateMicDataFromFields();
        updateOtherDataFromFields();
      }
      
      function updateSqlDataFromTable() {
        const calibData = getCalibData();
        if (!calibData) return;
        ['sqlBand4_7', 'sqlBand1_3'].forEach(band => {
          const layout = CAL_LAYOUT[band];
          for (let i = 0; i < 10; i++) {
            if (band === currentSqlBand) {
              calibData[layout.openRssiThr.addr - CAL_START + i] = getValue('sql_openRssi_' + i);
              calibData[layout.closeRssiThr.addr - CAL_START + i] = getValue('sql_closeRssi_' + i);
              calibData[layout.openNoiseThr.addr - CAL_START + i] = getValue('sql_openNoise_' + i);
              calibData[layout.closeNoiseThr.addr - CAL_START + i] = getValue('sql_closeNoise_' + i);
              calibData[layout.openGlitchThr.addr - CAL_START + i] = getValue('sql_openGlitch_' + i);
              calibData[layout.closeGlitchThr.addr - CAL_START + i] = getValue('sql_closeGlitch_' + i);
            }
          }
        });
      }
      
      function updateRssiDataFromFields() {
        const calibData = getCalibData();
        if (!calibData) return;
        setUint16(calibData, 0x1EC0 - CAL_START, getValue('rssi37_level1'));
        setUint16(calibData, 0x1EC2 - CAL_START, getValue('rssi37_level2'));
        setUint16(calibData, 0x1EC4 - CAL_START, getValue('rssi37_level4'));
        setUint16(calibData, 0x1EC6 - CAL_START, getValue('rssi37_level6'));
        setUint16(calibData, 0x1EC8 - CAL_START, getValue('rssi12_level1'));
        setUint16(calibData, 0x1ECA - CAL_START, getValue('rssi12_level2'));
        setUint16(calibData, 0x1ECC - CAL_START, getValue('rssi12_level4'));
        setUint16(calibData, 0x1ECE - CAL_START, getValue('rssi12_level6'));
      }
      
      function updateTxPowerDataFromFields() {
        const calibData = getCalibData();
        if (!calibData) return;
        const baseOffset = (0x1ED0 - CAL_START) + (currentTxBand * 16);
        calibData[baseOffset] = getValue('txp_low_lower');
        calibData[baseOffset + 1] = getValue('txp_low_center');
        calibData[baseOffset + 2] = getValue('txp_low_upper');
        calibData[baseOffset + 3] = getValue('txp_mid_lower');
        calibData[baseOffset + 4] = getValue('txp_mid_center');
        calibData[baseOffset + 5] = getValue('txp_mid_upper');
        calibData[baseOffset + 6] = getValue('txp_hi_lower');
        calibData[baseOffset + 7] = getValue('txp_hi_center');
        calibData[baseOffset + 8] = getValue('txp_hi_upper');
      }
      
      function updateBatteryDataFromFields() {
        const calibData = getCalibData();
        if (!calibData) return;
        for (let i = 0; i < 6; i++) {
          setUint16(calibData, (0x1F40 - CAL_START) + (i * 2), getValue('batLvl_' + i));
        }
      }
      
      function updateVoxDataFromFields() {
        const calibData = getCalibData();
        if (!calibData) return;
        for (let i = 0; i < 10; i++) {
          setUint16(calibData, (0x1F50 - CAL_START) + (i * 2), getValue('vox1Thr_' + i));
          setUint16(calibData, (0x1F68 - CAL_START) + (i * 2), getValue('vox0Thr_' + i));
        }
      }
      
      function updateMicDataFromFields() {
        const calibData = getCalibData();
        if (!calibData) return;
        for (let i = 0; i < 5; i++) {
          calibData[(0x1F80 - CAL_START) + i] = getValue('micLevel_' + i);
        }
      }
      
      function updateOtherDataFromFields() {
        const calibData = getCalibData();
        if (!calibData) return;
        setInt16(calibData, 0x1F88 - CAL_START, getValue('xtalFreqLow'));
        calibData[0x1F8E - CAL_START] = getValue('volumeGain');
        calibData[0x1F8F - CAL_START] = getValue('dacGain');
      }
      
      // Utility functions
      function setValue(id, value) {
        const el = document.getElementById(id);
        if (el) el.value = value;
      }
      
      function getValue(id) {
        const el = document.getElementById(id);
        return el ? parseInt(el.value) || 0 : 0;
      }
      
      function getUint16(data, offset) {
        return data[offset] | (data[offset + 1] << 8);
      }
      
      function setUint16(data, offset, value) {
        data[offset] = value & 0xFF;
        data[offset + 1] = (value >> 8) & 0xFF;
      }
      
      function getInt16(data, offset) {
        const val = getUint16(data, offset);
        return val > 32767 ? val - 65536 : val;
      }
      
      function setInt16(data, offset, value) {
        if (value < 0) value = 65536 + value;
        setUint16(data, offset, value);
      }
      
      // Initialize calibration on page load
      document.addEventListener('DOMContentLoaded', function() {
        initCalibrationTables();
        
        // Bind buttons
        const loadBtn = document.getElementById('calibLoadFileBtn');
        const fileInput = document.getElementById('calibFileInput');
        const writeFileBtn = document.getElementById('calibWriteFileBtn');
        
        if (loadBtn) loadBtn.addEventListener('click', () => fileInput.click());
        if (fileInput) fileInput.addEventListener('change', (e) => {
          if (e.target.files[0]) loadCalibrationFile(e.target.files[0]);
        });
        if (writeFileBtn) writeFileBtn.addEventListener('click', writeCalibrationFile);
      });
      // ============== END CALIBRATION SECTION ==============
    </script>
  
                        <footer class="page-footer">
          <p>Copyright 2026 and <span id="baseline-developed">developed by</span>&nbsp;<a href="https://github.com/spm81" target="_blank">Matoz</a>, based on <a href="https://home.joaquim.org/k5/" target="_blank">Joaquim(joaquim.org).</a><br>Special thanks to <a href="https://github.com/whosmatt/uvmod" target="_blank" rel="noopener">whosmatt</a> (The father of UVMOD, which later gave rise to UVTOOLS)</p>
        </footer>

  </body>
</html>